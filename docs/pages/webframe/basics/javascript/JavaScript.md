---
title: JavaScript
author: RJMeteor
createTime: 2024/12/02 04:41:42
permalink: /webframe/javascript/
---

##  ç°ä»£æ¨¡å¼

è¿™ä¸ªæŒ‡ä»¤çœ‹ä¸Šå»åƒä¸€ä¸ªå­—ç¬¦ä¸² `"use strict"` æˆ–è€… `'use strict'`ã€‚å½“å®ƒå¤„äºè„šæœ¬æ–‡ä»¶çš„é¡¶éƒ¨æ—¶ï¼Œåˆ™æ•´ä¸ªè„šæœ¬æ–‡ä»¶éƒ½å°†ä»¥â€œç°ä»£â€æ¨¡å¼è¿›è¡Œå·¥ä½œã€‚

- è¯·ç¡®ä¿ `"use strict"` å‡ºç°åœ¨è„šæœ¬çš„æœ€é¡¶éƒ¨ï¼Œå¦åˆ™ä¸¥æ ¼æ¨¡å¼å¯èƒ½æ— æ³•å¯ç”¨ã€‚
- ç°ä»£ JavaScript æ”¯æŒ â€œclassâ€ å’Œ â€œmoduleâ€ â€”â€” é«˜çº§è¯­è¨€ç»“æ„ï¼ˆæœ¬æ•™ç¨‹åç»­ç« èŠ‚ä¼šè®²åˆ°ï¼‰ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨å¯ç”¨ `use strict`ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å®ƒä»¬ï¼Œåˆ™æ— éœ€æ·»åŠ  `"use strict"` æŒ‡ä»¤ã€‚

## 5. å¯é€‰é“¾ "?."

~~~javascript
let user = {}; // user æ²¡æœ‰ address å±æ€§
alert( user?.address?.street ); // undefinedï¼ˆä¸æŠ¥é”™ï¼‰
~~~

- å¦‚æœå¯é€‰é“¾ `?.` å‰é¢çš„å€¼ä¸º `undefined` æˆ–è€… `null`ï¼Œå®ƒä¼šåœæ­¢è¿ç®—å¹¶è¿”å› `undefined`ã€‚

- `?.` è¯­æ³•ä½¿å…¶å‰é¢çš„å€¼æˆä¸ºå¯é€‰å€¼ï¼Œä½†ä¸ä¼šå¯¹å…¶åé¢çš„èµ·ä½œç”¨ã€‚

- `?.` å‰çš„å˜é‡å¿…é¡»å·²å£°æ˜

  å¦‚æœæœªå£°æ˜å˜é‡ `user`ï¼Œé‚£ä¹ˆ `user?.anything` ä¼šè§¦å‘ä¸€ä¸ªé”™è¯¯ï¼š

  ```javascript
  // ReferenceError: user is not defined
  user?.address;
  ```

  `?.` å‰çš„å˜é‡å¿…é¡»å·²å£°æ˜ï¼ˆä¾‹å¦‚ `let/const/var user` æˆ–ä½œä¸ºä¸€ä¸ªå‡½æ•°å‚æ•°ï¼‰ã€‚å¯é€‰é“¾ä»…é€‚ç”¨äºå·²å£°æ˜çš„å˜é‡ã€‚

- å¦‚æœ `?.` å·¦è¾¹éƒ¨åˆ†ä¸å­˜åœ¨ï¼Œå°±ä¼šç«‹å³åœæ­¢è¿ç®—ï¼ˆâ€œçŸ­è·¯æ•ˆåº”â€ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ `?.` çš„å³ä¾§æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„å‡½æ•°è°ƒç”¨æˆ–æ“ä½œï¼Œå®ƒä»¬å‡ä¸ä¼šæ‰§è¡Œã€‚

## 6. å‡½æ•°

- å‡½æ•°å£°æ˜ï¼šåœ¨ä¸»ä»£ç æµä¸­å£°æ˜ä¸ºå•ç‹¬çš„è¯­å¥çš„å‡½æ•°ã€‚

  **åœ¨å‡½æ•°å£°æ˜è¢«å®šä¹‰ä¹‹å‰ï¼Œå®ƒå°±å¯ä»¥è¢«è°ƒç”¨ã€‚**

  ~~~javascript
  function sayHi() {
    alert( "Hello" );
  }
  ~~~

- å‡½æ•°è¡¨è¾¾å¼ï¼šåœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­æˆ–å¦ä¸€ä¸ªè¯­æ³•ç»“æ„ä¸­åˆ›å»ºçš„å‡½æ•°ã€‚

  **å‡½æ•°è¡¨è¾¾å¼æ˜¯åœ¨ä»£ç æ‰§è¡Œåˆ°è¾¾æ—¶è¢«åˆ›å»ºï¼Œå¹¶ä¸”ä»…ä»é‚£ä¸€åˆ»èµ·å¯ç”¨ã€‚**

  ~~~javascript
  let sayHi = function() {
    alert( "Hello" );
  };
  ~~~

- å‡½æ•°æ˜¯ä¸ªå€¼ã€‚æ— è®ºå‡½æ•°æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå€¼ã€‚æ— è®ºå‡½æ•°æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œå‡½æ•°éƒ½æ˜¯ä¸€ä¸ªå€¼ã€‚

- å‡½æ•°æœ‰this

## 7. ç®­å¤´å‡½æ•°

::: warning æ·±å…¥ç†è§£ç®­å¤´å‡½æ•°

- **ç®­å¤´å‡½æ•°æ²¡æœ‰â€œthis"**ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰ `this`ã€‚å¦‚æœè®¿é—® `this`ï¼Œ
  - ç®­å¤´å‡½æ•°æ²¡æœ‰å£°æ˜åœ¨æ™®é€šå‡½æ•°å—ä¸­ï¼Œthisæ°¸è¿œæŒ‡å‘windowï¼Œåä¹‹thisæŒ‡å‘è°ƒç”¨æ™®é€šå‡½æ•°é‚£ä¸ªå¯¹è±¡ã€‚
  
- **ä¸èƒ½å¯¹ç®­å¤´å‡½æ•°è¿›è¡Œ** `new` **æ“ä½œ**
- **ç®­å¤´å‡½æ•°æ²¡æœ‰**`arguments`

~~~js
const Person = {
    name: "John",
    age: 32,
    sex:"male",
    children:{
        goa:"faa",
        children: {
            lsdf:()=>{
                console.log(this)  // Window
            }
        }
    },
    renjia(){
        const  lfaf = ()=>{
            this.children.children.lsdf()
            console.log(this) // Person
        }
        lfaf()
    }
}
~~~

:::

ç®­å¤´å‡½æ•°å¯ä»¥åƒå‡½æ•°è¡¨è¾¾å¼ä¸€æ ·ä½¿ç”¨ã€‚

~~~javascript
let age = prompt("What is your age?", 18);
let welcome = (age < 18) ?
  () => alert('Hello'!) :
  () => alert("Greetings!");
welcome();
~~~

ç®­å¤´å‡½æ•°å¯¹äºç®€å•çš„æ“ä½œå¾ˆæ–¹ä¾¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå•è¡Œçš„å‡½æ•°ã€‚å®ƒå…·ä½“æœ‰ä¸¤ç§å½¢å¼ï¼š

- ä¸å¸¦èŠ±æ‹¬å·ï¼š`(...args) => expression` â€” å³ä¾§æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼šå‡½æ•°è®¡ç®—è¡¨è¾¾å¼å¹¶è¿”å›å…¶ç»“æœã€‚å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåˆ™å¯ä»¥çœç•¥æ‹¬å·ï¼Œä¾‹å¦‚ `n => n*2`ã€‚

- å¸¦èŠ±æ‹¬å·ï¼š`(...args) => { body }` â€” èŠ±æ‹¬å·å…è®¸æˆ‘ä»¬åœ¨å‡½æ•°ä¸­ç¼–å†™å¤šä¸ªè¯­å¥ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æ˜¾å¼åœ° `return` æ¥è¿”å›ä¸€äº›å†…å®¹ã€‚

## 8. å¯¹è±¡å¼•ç”¨å’Œå¤åˆ¶

ä¸åŸå§‹ç±»å‹ç›¸æ¯”ï¼Œå¯¹è±¡çš„æ ¹æœ¬åŒºåˆ«ä¹‹ä¸€æ˜¯å¯¹è±¡æ˜¯â€œé€šè¿‡å¼•ç”¨â€è¢«å­˜å‚¨å’Œå¤åˆ¶çš„ï¼Œä¸åŸå§‹ç±»å‹å€¼ç›¸åï¼šå­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”å€¼ç­‰ â€”â€” å§‹ç»ˆæ˜¯ä»¥â€œæ•´ä½“å€¼â€çš„å½¢å¼è¢«å¤åˆ¶çš„ã€‚

**èµ‹å€¼äº†å¯¹è±¡çš„å˜é‡å­˜å‚¨çš„ä¸æ˜¯å¯¹è±¡æœ¬èº«ï¼Œè€Œæ˜¯è¯¥å¯¹è±¡â€œåœ¨å†…å­˜ä¸­çš„åœ°å€â€ â€”â€” æ¢å¥è¯è¯´å°±æ˜¯å¯¹è¯¥å¯¹è±¡çš„â€œå¼•ç”¨â€ã€‚**

å…‹éš†ä¸åˆå¹¶ï¼š

~~~javascript
Object.assign(dest, [src1, src2, src3...])
~~~

- ç¬¬ä¸€ä¸ªå‚æ•° `dest` æ˜¯æŒ‡ç›®æ ‡å¯¹è±¡ã€‚
- æ›´åé¢çš„å‚æ•° `src1, ..., srcN`ï¼ˆå¯æŒ‰éœ€ä¼ é€’å¤šä¸ªå‚æ•°ï¼‰æ˜¯æºå¯¹è±¡ã€‚
- è¯¥æ–¹æ³•å°†æ‰€æœ‰æºå¯¹è±¡çš„å±æ€§æ‹·è´åˆ°ç›®æ ‡å¯¹è±¡ `dest` ä¸­ã€‚æ¢å¥è¯è¯´ï¼Œä»ç¬¬äºŒä¸ªå¼€å§‹çš„æ‰€æœ‰å‚æ•°çš„å±æ€§éƒ½è¢«æ‹·è´åˆ°ç¬¬ä¸€ä¸ªå‚æ•°çš„å¯¹è±¡ä¸­ã€‚
- è°ƒç”¨ç»“æœè¿”å› `dest`ã€‚

~~~javascript
let user = {
  name: "John",
  sizes: {
    height: 182,
    width: 50
  }
};

let clone = Object.assign({}, user);

alert( user.sizes === clone.sizes ); // trueï¼ŒåŒä¸€ä¸ªå¯¹è±¡

// user å’Œ clone åˆ†äº«åŒä¸€ä¸ª sizes
user.sizes.width++;       // é€šè¿‡å…¶ä¸­ä¸€ä¸ªæ”¹å˜å±æ€§å€¼
alert(clone.sizes.width); // 51ï¼Œèƒ½ä»å¦å¤–ä¸€ä¸ªçœ‹åˆ°å˜æ›´çš„ç»“æœ
~~~

ç°åœ¨è¿™æ ·æ‹·è´`clone.sizes = user.sizes` å·²ç»ä¸è¶³å¤Ÿäº†ï¼Œå› ä¸º `user.sizes` æ˜¯ä¸ªå¯¹è±¡ï¼Œå®ƒä¼šä»¥å¼•ç”¨å½¢å¼è¢«æ‹·è´ã€‚å› æ­¤ `clone` å’Œ `user` ä¼šå…±ç”¨ä¸€ä¸ª sizesã€‚

## 9. Symbol ç±»å‹

- `Symbolå€¼`è¡¨ç¤ºå”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚

- æˆ‘ä»¬å¯ä»¥ç»™ Symbol ä¸€ä¸ªæè¿°ï¼ˆä¹Ÿç§°ä¸º Symbol åï¼‰ï¼Œè¿™åœ¨ä»£ç è°ƒè¯•æ—¶éå¸¸æœ‰ç”¨ï¼š

  ~~~javascript
  // id æ˜¯ symbol çš„ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡
  // id æ˜¯æè¿°ä¸º "id" çš„ Symbol
  let id = Symbol("id");
  ~~~

  Symbol ä¿è¯æ˜¯å”¯ä¸€çš„ã€‚å³ä½¿æˆ‘ä»¬åˆ›å»ºäº†è®¸å¤šå…·æœ‰ç›¸åŒæè¿°çš„ Symbolï¼Œå®ƒä»¬çš„å€¼ä¹Ÿæ˜¯ä¸åŒã€‚æè¿°åªæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œä¸å½±å“ä»»ä½•ä¸œè¥¿ã€‚

- **Symbol ä¸ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå­—ç¬¦ä¸²**

  å¦‚æœæˆ‘ä»¬çœŸçš„æƒ³æ˜¾ç¤ºä¸€ä¸ª Symbolï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®ƒä¸Šé¢è°ƒç”¨ `.toString()`ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

  ~~~javascript
  let id = Symbol("id");
  alert(id.toString()); // Symbol(id)ï¼Œç°åœ¨å®ƒæœ‰æ•ˆäº†
  ~~~

  æˆ–è€…è·å– `symbol.description` å±æ€§ï¼Œåªæ˜¾ç¤ºæè¿°ï¼ˆdescriptionï¼‰ï¼š

  ~~~javascript
  let id = Symbol("id");
  alert(id.description); // id
  ~~~

- **â€œéšè—â€å±æ€§**

  Symbol å…è®¸æˆ‘ä»¬åˆ›å»ºå¯¹è±¡çš„â€œéšè—â€å±æ€§ï¼Œä»£ç çš„ä»»ä½•å…¶ä»–éƒ¨åˆ†éƒ½ä¸èƒ½æ„å¤–è®¿é—®æˆ–é‡å†™è¿™äº›å±æ€§ã€‚

  ä½¿ç”¨ `Symbol("id")` ä½œä¸ºé”®ï¼Œæ¯”èµ·ç”¨å­—ç¬¦ä¸² `"id"` æ¥æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ

  å› ä¸º `user` å¯¹è±¡å±äºå…¶ä»–çš„ä»£ç ï¼Œé‚£äº›ä»£ç ä¹Ÿä¼šä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸åº”è¯¥åœ¨å®ƒä¸Šé¢ç›´æ¥æ·»åŠ ä»»ä½•å­—æ®µï¼Œè¿™æ ·å¾ˆä¸å®‰å…¨ã€‚ä½†æ˜¯ä½ æ·»åŠ çš„ Symbol å±æ€§ä¸ä¼šè¢«æ„å¤–è®¿é—®åˆ°ï¼Œç¬¬ä¸‰æ–¹ä»£ç æ ¹æœ¬ä¸ä¼šçœ‹åˆ°å®ƒï¼Œæ‰€ä»¥ä½¿ç”¨ Symbol åŸºæœ¬ä¸Šä¸ä¼šæœ‰é—®é¢˜ã€‚

  å¦å¤–ï¼Œå‡è®¾å¦ä¸€ä¸ªè„šæœ¬å¸Œæœ›åœ¨ `user` ä¸­æœ‰è‡ªå·±çš„æ ‡è¯†ç¬¦ï¼Œä»¥å®ç°è‡ªå·±çš„ç›®çš„ã€‚è¿™å¯èƒ½æ˜¯å¦ä¸€ä¸ª JavaScript åº“ï¼Œå› æ­¤è„šæœ¬ä¹‹é—´å®Œå…¨ä¸äº†è§£å½¼æ­¤ã€‚

- **å¯¹è±¡å­—é¢é‡ä¸­çš„ Symbol**

  ~~~javascript
  let id = Symbol("id");
  
  let user = {
    name: "John",
    [id]: 123 // è€Œä¸æ˜¯ "id"ï¼š123
  };
  ~~~

  è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦å˜é‡ `id` çš„å€¼ä½œä¸ºé”®ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸² â€œidâ€ã€‚

- **Symbol åœ¨ forâ€¦in ä¸­ä¼šè¢«è·³è¿‡**

  `Object.keys(user) `ä¹Ÿä¼šå¿½ç•¥å®ƒä»¬ã€‚è¿™æ˜¯ä¸€èˆ¬â€œéšè—ç¬¦å·å±æ€§â€åŸåˆ™çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœå¦ä¸€ä¸ªè„šæœ¬æˆ–åº“éå†æˆ‘ä»¬çš„å¯¹è±¡ï¼Œå®ƒä¸ä¼šæ„å¤–åœ°è®¿é—®åˆ°ç¬¦å·å±æ€§ã€‚

  ç›¸åï¼Œ`Object.assign()`ä¼šåŒæ—¶å¤åˆ¶å­—ç¬¦ä¸²å’Œ symbol å±æ€§ï¼š

- **å…¨å±€ symbol**

  æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œé€šå¸¸æ‰€æœ‰çš„ Symbol éƒ½æ˜¯ä¸åŒçš„ï¼Œå³ä½¿å®ƒä»¬æœ‰ç›¸åŒçš„åå­—ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬æƒ³è¦åå­—ç›¸åŒçš„ Symbol å…·æœ‰ç›¸åŒçš„å®ä½“ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºçš„ä¸åŒéƒ¨åˆ†æƒ³è¦è®¿é—®çš„ Symbol `"id"` æŒ‡çš„æ˜¯å®Œå…¨ç›¸åŒçš„å±æ€§ã€‚

  ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª **å…¨å±€ Symbol æ³¨å†Œè¡¨**ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­åˆ›å»º Symbol å¹¶åœ¨ç¨åè®¿é—®å®ƒä»¬ï¼Œå®ƒå¯ä»¥ç¡®ä¿æ¯æ¬¡è®¿é—®ç›¸åŒåå­—çš„ Symbol æ—¶ï¼Œè¿”å›çš„éƒ½æ˜¯ç›¸åŒçš„ Symbolã€‚

  è¦ä»æ³¨å†Œè¡¨ä¸­è¯»å–ï¼ˆä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰Symbolï¼Œè¯·ä½¿ç”¨ `Symbol.for(key)`ã€‚

  å¯¹äºå…¨å±€ Symbolï¼Œä¸ä»…æœ‰ `Symbol.for(key)` æŒ‰åå­—è¿”å›ä¸€ä¸ª Symbolï¼Œè¿˜æœ‰ä¸€ä¸ªåå‘è°ƒç”¨ï¼š`Symbol.keyFor(sym)`ï¼Œå®ƒçš„ä½œç”¨å®Œå…¨åè¿‡æ¥ï¼šé€šè¿‡å…¨å±€ Symbol è¿”å›ä¸€ä¸ªåå­—ã€‚

  ä¾‹å¦‚ï¼š

  ~~~
  // é€šè¿‡ name è·å– Symbol
  let sym = Symbol.for("name");
  let sym2 = Symbol.for("id");
  
  // é€šè¿‡ Symbol è·å– name
  alert( Symbol.keyFor(sym) ); // name
  alert( Symbol.keyFor(sym2) ); // id
  ~~~
  
- **ç³»ç»Ÿ Symbol**

  JavaScript å†…éƒ¨æœ‰å¾ˆå¤šâ€œç³»ç»Ÿâ€ Symbolï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥å¾®è°ƒå¯¹è±¡çš„å„ä¸ªæ–¹é¢ã€‚

  å®ƒä»¬éƒ½è¢«åˆ—åœ¨äº† [ä¼—æ‰€å‘¨çŸ¥çš„ Symbol](https://tc39.github.io/ecma262/#sec-well-known-symbols) è¡¨çš„è§„èŒƒä¸­ï¼š

  - `Symbol.hasInstance`
  - `Symbol.isConcatSpreadable`
  - `Symbol.iterator`
  - `Symbol.toPrimitive`
  - â€¦â€¦ç­‰ç­‰ã€‚

  ä¾‹å¦‚ï¼Œ`Symbol.toPrimitive` å…è®¸æˆ‘ä»¬å°†å¯¹è±¡æè¿°ä¸ºåŸå§‹å€¼è½¬æ¢ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šçœ‹åˆ°å®ƒçš„ä½¿ç”¨ã€‚

## 10. æ•°å­¦ç±»å‹

**toString(base)**: `num.toString(base)` è¿”å›åœ¨ç»™å®š `base` è¿›åˆ¶æ•°å­—ç³»ç»Ÿä¸­ `num` çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚

**toFixed(n)**ï¼šå°†æ•°å­—èˆå…¥åˆ°å°æ•°ç‚¹å `n` ä½ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ç»“æœã€‚

**isFinite(value)**ï¼šå°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚æœæ˜¯å¸¸è§„æ•°å­—ï¼Œåˆ™è¿”å› `true`ï¼Œè€Œä¸æ˜¯ `NaN/Infinity/-Infinity`ï¼š

**isNaN(value)**ï¼šå°†å…¶å‚æ•°è½¬æ¢ä¸ºæ•°å­—ï¼Œç„¶åæµ‹è¯•å®ƒæ˜¯å¦ä¸º `NaN`

**parseInt(str, radix)**ï¼š

`parseInt()` å‡½æ•°å…·æœ‰å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚å®ƒæŒ‡å®šäº†æ•°å­—ç³»ç»Ÿçš„åŸºæ•°ï¼Œå› æ­¤ `parseInt` è¿˜å¯ä»¥è§£æåå…­è¿›åˆ¶æ•°å­—ã€äºŒè¿›åˆ¶æ•°å­—ç­‰çš„å­—ç¬¦ä¸²ï¼š

`parseInt` å’Œ `parseFloat` çš„ä½œç”¨ã€‚

å®ƒä»¬å¯ä»¥ä»å­—ç¬¦ä¸²ä¸­â€œè¯»å–â€æ•°å­—ï¼Œç›´åˆ°æ— æ³•è¯»å–ä¸ºæ­¢ã€‚å¦‚æœå‘ç”Ÿ errorï¼Œåˆ™è¿”å›æ”¶é›†åˆ°çš„æ•°å­—ã€‚å‡½æ•° `parseInt` è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œè€Œ `parseFloat` è¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°ï¼š

```javascript
alert( parseInt('100px') ); // 100
alert( parseFloat('12.5em') ); // 12.5
```

## 11. æ•°ç»„æ–¹æ³•

::: tip **æ·»åŠ /ç§»é™¤æ•°ç»„å…ƒç´ **

- `arr.push(...items)` â€”â€” ä»å°¾ç«¯æ·»åŠ å…ƒç´ ï¼Œ
- `arr.pop()` â€”â€” ä»å°¾ç«¯æå–å…ƒç´ ï¼Œ
- `arr.shift()` â€”â€” ä»é¦–ç«¯æå–å…ƒç´ ï¼Œ
- `arr.unshift(...items)` â€”â€” ä»é¦–ç«¯æ·»åŠ å…ƒç´ ã€‚
**splice**ï¼šå¯ä»¥åšæ‰€æœ‰äº‹æƒ…ï¼šæ·»åŠ ï¼Œåˆ é™¤å’Œæ’å…¥å…ƒç´ ã€‚

:::

### 11.1 splice

~~~javascript
arr.splice(start[, deleteCount[, elem1, ..., elemN]])
~~~
å®ƒä»ç´¢å¼• `start` å¼€å§‹ä¿®æ”¹ `arr`ï¼šåˆ é™¤ `deleteCount` ä¸ªå…ƒç´ å¹¶åœ¨å½“å‰ä½ç½®æ’å…¥ `elem1, ..., elemN`ã€‚æœ€åè¿”å›å·²è¢«åˆ é™¤å…ƒç´ çš„æ•°ç»„ã€‚

### 11.2 **slice**ï¼š

~~~javascript
arr.slice([start], [end])
~~~
å®ƒä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œå°†æ‰€æœ‰ä»ç´¢å¼• `start` åˆ° `end-1`çš„æ•°ç»„é¡¹å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚`start` å’Œ `end` éƒ½å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»æœ«å°¾è®¡ç®—ç´¢å¼•ã€‚

### **11.3 concat**ï¼š

~~~javascript
arr.concat(arg1, arg2...)
~~~
åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªäºå…¶ä»–æ•°ç»„å’Œå…¶ä»–é¡¹çš„å€¼ã€‚

å®ƒæ¥å—ä»»æ„æ•°é‡çš„å‚æ•° â€”â€” æ•°ç»„æˆ–å€¼éƒ½å¯ä»¥ã€‚

ç»“æœæ˜¯ä¸€ä¸ªåŒ…å«æ¥è‡ªäº `arr`ï¼Œç„¶åæ˜¯ `arg1`ï¼Œ`arg2` çš„å…ƒç´ çš„æ–°æ•°ç»„ã€‚

å¦‚æœå‚æ•° `argN` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¼šè¢«å¤åˆ¶ã€‚å¦åˆ™ï¼Œå°†å¤åˆ¶å‚æ•°æœ¬èº«ã€‚

### 11.4 **forEach**ï¼š

å…è®¸ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½è¿è¡Œä¸€ä¸ªå‡½æ•°ã€‚

~~~javascript
arr.forEach(function(item, index, array) {
  // ... do something with item
});
~~~

### 11.5 **indexOf/lastIndexOf å’Œ includes**ï¼š

ä¸å­—ç¬¦ä¸²æ“ä½œå…·æœ‰ç›¸åŒçš„è¯­æ³•ï¼Œå¹¶ä¸”ä½œç”¨åŸºæœ¬ä¸Šä¹Ÿä¸å­—ç¬¦ä¸²çš„æ–¹æ³•ç›¸åŒï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯å¯¹æ•°ç»„å…ƒç´ è€Œä¸æ˜¯å­—ç¬¦è¿›è¡Œæ“ä½œï¼š

- `arr.indexOf(item, from)` ä»ç´¢å¼• `from` å¼€å§‹æœç´¢ `item`ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ç´¢å¼•ï¼Œå¦åˆ™è¿”å› `-1`ã€‚
- `arr.lastIndexOf(item, from)` â€”â€” å’Œä¸Šé¢ç›¸åŒï¼Œåªæ˜¯ä»å³å‘å·¦æœç´¢ã€‚
- `arr.includes(item, from)` â€”â€” ä»ç´¢å¼• `from` å¼€å§‹æœç´¢ `item`ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å› `true`ï¼ˆè¯‘æ³¨ï¼šå¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å› `false`ï¼‰ã€‚

### 11.6 **find å’Œ findIndex**

~~~javascript
let result = arr.find(function(item, index, array) {
  // å¦‚æœè¿”å› trueï¼Œåˆ™è¿”å› item å¹¶åœæ­¢è¿­ä»£
  // å¯¹äºå‡å€¼ï¼ˆfalsyï¼‰çš„æƒ…å†µï¼Œåˆ™è¿”å› undefined
});
~~~

ä¾æ¬¡å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨è¯¥å‡½æ•°ï¼š

- `item` æ˜¯å…ƒç´ ã€‚
- `index` æ˜¯å®ƒçš„ç´¢å¼•ã€‚
- `array` æ˜¯æ•°ç»„æœ¬èº«ã€‚

å¦‚æœå®ƒè¿”å› `true`ï¼Œåˆ™æœç´¢åœæ­¢ï¼Œå¹¶è¿”å› `item`ã€‚å¦‚æœæ²¡æœ‰æœç´¢åˆ°ï¼Œåˆ™è¿”å› `undefined`ã€‚

`arr.findIndex`æ–¹æ³•ï¼ˆä¸ `arr.find` æ–¹æ³•ï¼‰åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œä½†å®ƒè¿”å›æ‰¾åˆ°å…ƒç´ çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯å…ƒç´ æœ¬èº«ã€‚å¹¶ä¸”åœ¨æœªæ‰¾åˆ°ä»»ä½•å†…å®¹æ—¶è¿”å› `-1`ã€‚

### 11.7 **filter**ï¼š

`find` æ–¹æ³•æœç´¢çš„æ˜¯ä½¿å‡½æ•°è¿”å› `true` çš„ç¬¬ä¸€ä¸ªï¼ˆå•ä¸ªï¼‰å…ƒç´ ã€‚

å¦‚æœéœ€è¦åŒ¹é…çš„æœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨` arr.filter(fn)`ã€‚

è¯­æ³•ä¸ `find` å¤§è‡´ç›¸åŒï¼Œä½†æ˜¯ `filter` è¿”å›çš„æ˜¯æ‰€æœ‰åŒ¹é…å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼š

~~~javascript
let results = arr.filter(function(item, index, array) {
  // å¦‚æœ true item è¢« push åˆ° resultsï¼Œè¿­ä»£ç»§ç»­
  // å¦‚æœä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°ï¼Œåˆ™è¿”å›ç©ºæ•°ç»„
});
~~~

### 11.8 **map**ï¼š

å®ƒå¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½è°ƒç”¨å‡½æ•°ï¼Œå¹¶è¿”å›ç»“æœæ•°ç»„ã€‚

~~~javascript
let result = arr.map(function(item, index, array) {
  // è¿”å›æ–°å€¼è€Œä¸æ˜¯å½“å‰å…ƒç´ 
})
~~~

### 11.9 **split å’Œ join**ï¼š

`str.split(delim)` æ–¹æ³•å¯ä»¥åšåˆ°ã€‚å®ƒé€šè¿‡ç»™å®šçš„åˆ†éš”ç¬¦ `delim` å°†å­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ä¸ªæ•°ç»„ã€‚

`arr.join(glue)` ä¸ `split` ç›¸åã€‚å®ƒä¼šåœ¨å®ƒä»¬ä¹‹é—´åˆ›å»ºä¸€ä¸²ç”± `glue` ç²˜åˆçš„ `arr` é¡¹ã€‚

11.10 **reduce**ï¼š

ç”¨äºæ ¹æ®æ•°ç»„è®¡ç®—å•ä¸ªå€¼

~~~javascript
let value = arr.reduce(function(accumulator, item, index, array) {
  // ...
}, [initial]);
~~~

è¯¥å‡½æ•°ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°åº”ç”¨äºæ‰€æœ‰æ•°ç»„å…ƒç´ ï¼Œå¹¶å°†å…¶ç»“æœâ€œæ¬è¿ï¼ˆcarry onï¼‰â€åˆ°ä¸‹ä¸€ä¸ªè°ƒç”¨ã€‚

å‚æ•°ï¼š

- `accumulator` â€”â€” æ˜¯ä¸Šä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ç»“æœï¼Œç¬¬ä¸€æ¬¡ç­‰äº `initial`ï¼ˆå¦‚æœæä¾›äº† `initial` çš„è¯ï¼‰ã€‚æœ¬è´¨ä¸Šæ˜¯ç´¯åŠ å™¨
- `item` â€”â€” å½“å‰çš„æ•°ç»„å…ƒç´ ã€‚
- `index` â€”â€” å½“å‰ç´¢å¼•ã€‚
- `arr` â€”â€” æ•°ç»„æœ¬èº«ã€‚

> å¦‚æœ `fn` è¿”å›ä¸€ä¸ªçœŸå€¼ï¼Œ`arr.some(fn)` ç«‹å³è¿”å› `true` å¹¶åœæ­¢è¿­ä»£å…¶ä½™æ•°ç»„é¡¹ï¼›å¦‚æœ `fn` è¿”å›ä¸€ä¸ªå‡å€¼ï¼Œ`arr.every(fn)` ç«‹å³è¿”å› `false` å¹¶åœæ­¢å¯¹å…¶ä½™æ•°ç»„é¡¹çš„è¿­ä»£ã€‚



## 12. Iterable objectï¼ˆå¯è¿­ä»£å¯¹è±¡ï¼‰

### 12.1 **Symbol.iterator**ï¼šæœ‰è¯¥å±æ€§çš„å¯¹è±¡æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ï¼ˆå¯éå†ï¼‰

å¯ä»¥åº”ç”¨ `for..of` çš„å¯¹è±¡è¢«ç§°ä¸º **å¯è¿­ä»£çš„**ã€‚

ä¸ºäº†è®© `range` å¯¹è±¡å¯è¿­ä»£ï¼ˆä¹Ÿå°±è®© `for..of` å¯ä»¥è¿è¡Œï¼‰æˆ‘ä»¬éœ€è¦ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªåä¸º `Symbol.iterator` çš„æ–¹æ³•ï¼ˆä¸€ä¸ªä¸“é—¨ç”¨äºä½¿å¯¹è±¡å¯è¿­ä»£çš„å†…å»º symbolï¼‰ã€‚

1. å½“ `for..of` å¾ªç¯å¯åŠ¨æ—¶ï¼Œå®ƒä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±ä¼šæŠ¥é”™ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª **è¿­ä»£å™¨ï¼ˆiteratorï¼‰** â€”â€” ä¸€ä¸ªæœ‰ `next` æ–¹æ³•çš„å¯¹è±¡ã€‚

2. ä»æ­¤å¼€å§‹ï¼Œ`for..of` **ä»…é€‚ç”¨äºè¿™ä¸ªè¢«è¿”å›çš„å¯¹è±¡**ã€‚

3. å½“ `for..of` å¾ªç¯å¸Œæœ›å–å¾—ä¸‹ä¸€ä¸ªæ•°å€¼ï¼Œå®ƒå°±è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„ `next()` æ–¹æ³•ã€‚

4. `next()` æ–¹æ³•è¿”å›çš„ç»“æœçš„æ ¼å¼å¿…é¡»æ˜¯ `{done: Boolean, value: any}`ï¼Œå½“ `done=true` æ—¶ï¼Œè¡¨ç¤ºå¾ªç¯ç»“æŸï¼Œå¦åˆ™ `value` æ˜¯ä¸‹ä¸€ä¸ªå€¼ã€‚

   ~~~javascript
   let range = {
     from: 1,
     to: 5
   };
   
   // 1. for..of è°ƒç”¨é¦–å…ˆä¼šè°ƒç”¨è¿™ä¸ªï¼š
   range[Symbol.iterator] = function() {
   
     // â€¦â€¦å®ƒè¿”å›è¿­ä»£å™¨å¯¹è±¡ï¼ˆiterator objectï¼‰ï¼š
     // 2. æ¥ä¸‹æ¥ï¼Œfor..of ä»…ä¸ä¸‹é¢çš„è¿­ä»£å™¨å¯¹è±¡ä¸€èµ·å·¥ä½œï¼Œè¦æ±‚å®ƒæä¾›ä¸‹ä¸€ä¸ªå€¼
     return {
       current: this.from,
       last: this.to,
   
       // 3. next() åœ¨ for..of çš„æ¯ä¸€è½®å¾ªç¯è¿­ä»£ä¸­è¢«è°ƒç”¨
       next() {
         // 4. å®ƒå°†ä¼šè¿”å› {done:.., value :...} æ ¼å¼çš„å¯¹è±¡
         if (this.current <= this.last) {
           return { done: false, value: this.current++ };
         } else {
           return { done: true };
         }
       }
     };
   };
   
   // ç°åœ¨å®ƒå¯ä»¥è¿è¡Œäº†ï¼
   for (let num of range) {
     alert(num); // 1, ç„¶åæ˜¯ 2, 3, 4, 5
   }
   ~~~

### 12.2 **Array.from**

æœ‰ä¸€ä¸ªå…¨å±€æ–¹æ³•` Array.from`å¯ä»¥æ¥å—ä¸€ä¸ªå¯è¿­ä»£æˆ–ç±»æ•°ç»„çš„å€¼ï¼Œå¹¶ä»ä¸­è·å–ä¸€ä¸ªâ€œçœŸæ­£çš„â€æ•°ç»„ã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è°ƒç”¨æ•°ç»„æ–¹æ³•äº†ã€‚

~~~javascript
Array.from(obj[, mapFn, thisArg])
~~~

å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•° `mapFn` å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å¯¹è±¡ä¸­çš„å…ƒç´ è¢«æ·»åŠ åˆ°æ•°ç»„å‰ï¼Œè¢«åº”ç”¨äºæ¯ä¸ªå…ƒç´ ï¼Œæ­¤å¤– `thisArg` å…è®¸æˆ‘ä»¬ä¸ºè¯¥å‡½æ•°è®¾ç½® `this`ã€‚



## 13. Map and Setï¼ˆæ˜ å°„å’Œé›†åˆï¼‰

::: tip

- `Object.keys(obj)`â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„é”®çš„æ•°ç»„ã€‚
- `Object.values(obj)`â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰çš„å€¼çš„æ•°ç»„ã€‚
- `Object.entries(obj)` â€”â€” è¿”å›ä¸€ä¸ªåŒ…å«è¯¥å¯¹è±¡æ‰€æœ‰ [key, value] é”®å€¼å¯¹çš„æ•°ç»„ã€‚

:::

### 13.1 **Map**

`Map` æ˜¯ä¸€ä¸ªå¸¦é”®çš„æ•°æ®é¡¹çš„é›†åˆï¼Œå°±åƒä¸€ä¸ª `Object` ä¸€æ ·ã€‚ ä½†æ˜¯å®ƒä»¬æœ€å¤§çš„å·®åˆ«æ˜¯ `Map` å…è®¸ä»»ä½•ç±»å‹çš„é”®ï¼ˆkeyï¼‰ã€‚

å®ƒçš„æ–¹æ³•å’Œå±æ€§å¦‚ä¸‹ï¼š

- `new Map()` â€”â€” åˆ›å»º mapã€‚
- `map.set(key, value)` â€”â€” æ ¹æ®é”®å­˜å‚¨å€¼ã€‚
- `map.get(key)` â€”â€” æ ¹æ®é”®æ¥è¿”å›å€¼ï¼Œå¦‚æœ `map` ä¸­ä¸å­˜åœ¨å¯¹åº”çš„ `key`ï¼Œåˆ™è¿”å› `undefined`ã€‚
- `map.has(key)` â€”â€” å¦‚æœ `key` å­˜åœ¨åˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `map.delete(key)` â€”â€” åˆ é™¤æŒ‡å®šé”®çš„å€¼ã€‚
- `map.clear()` â€”â€” æ¸…ç©º mapã€‚
- `map.size` â€”â€” è¿”å›å½“å‰å…ƒç´ ä¸ªæ•°ã€‚

#### 13.1.1 **Map è¿˜å¯ä»¥ä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®ã€‚**

**é“¾å¼è°ƒç”¨**ï¼šæ¯ä¸€æ¬¡ `map.set` è°ƒç”¨éƒ½ä¼šè¿”å› map æœ¬èº«ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œâ€œé“¾å¼â€è°ƒç”¨

~~~javascript
map.set('1', 'str1')
  .set(1, 'num1')
  .set(true, 'bool1');
~~~

#### 13.1.2 **Map è¿­ä»£ï¼š**

å¦‚æœè¦åœ¨ `map` é‡Œä½¿ç”¨å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼š

- `map.keys()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„é”®ï¼ˆreturns an iterable for keysï¼‰ï¼Œ

- `map.values()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å€¼ï¼ˆreturns an iterable for valuesï¼‰ï¼Œ

- `map.entries()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å®ä½“ï¼ˆreturns an iterable for entriesï¼‰`[key, value]`ï¼Œ`for..of` åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªã€‚

- `Object.entries`ï¼šä»å¯¹è±¡åˆ›å»º Map

  å¦‚æœæˆ‘ä»¬æƒ³ä»ä¸€ä¸ªå·²æœ‰çš„æ™®é€šå¯¹è±¡ï¼ˆplain objectï¼‰æ¥åˆ›å»ºä¸€ä¸ª `Map`

  ~~~javascript
  let obj = {
    name: "John",
    age: 30
  };
  
  let map = new Map(Object.entries(obj));
  
  alert( map.get('name') ); // John
  ~~~

- `Object.fromEntries`ï¼šä» Map åˆ›å»ºå¯¹è±¡

  `Object.fromEntries` :ç»™å®šä¸€ä¸ªå…·æœ‰ `[key, value]` é”®å€¼å¯¹çš„æ•°ç»„ï¼Œå®ƒä¼šæ ¹æ®ç»™å®šæ•°ç»„åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼š

  ~~~javascript
  let prices = Object.fromEntries([
    ['banana', 1],
    ['orange', 2],
    ['meat', 4]
  ]);
  
  // ç°åœ¨ prices = { banana: 1, orange: 2, meat: 4 }
  
  alert(prices.orange); // 2
  ~~~

### 13.2 **Set**

`Set` æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»å‹é›†åˆ â€”â€” â€œå€¼çš„é›†åˆâ€ï¼ˆæ²¡æœ‰é”®ï¼‰ï¼Œå®ƒçš„æ¯ä¸€ä¸ªå€¼åªèƒ½å‡ºç°ä¸€æ¬¡ã€‚

å®ƒçš„ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š

- `new Set(iterable)` â€”â€” åˆ›å»ºä¸€ä¸ª `set`ï¼Œå¦‚æœæä¾›äº†ä¸€ä¸ª `iterable` å¯¹è±¡ï¼ˆé€šå¸¸æ˜¯æ•°ç»„ï¼‰ï¼Œå°†ä¼šä»æ•°ç»„é‡Œé¢å¤åˆ¶å€¼åˆ° `set` ä¸­ã€‚
- `set.add(value)` â€”â€” æ·»åŠ ä¸€ä¸ªå€¼ï¼Œè¿”å› set æœ¬èº«
- `set.delete(value)` â€”â€” åˆ é™¤å€¼ï¼Œå¦‚æœ `value` åœ¨è¿™ä¸ªæ–¹æ³•è°ƒç”¨çš„æ—¶å€™å­˜åœ¨åˆ™è¿”å› `true` ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `set.has(value)` â€”â€” å¦‚æœ `value` åœ¨ set ä¸­ï¼Œè¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚
- `set.clear()` â€”â€” æ¸…ç©º setã€‚
- `set.size` â€”â€” è¿”å›å…ƒç´ ä¸ªæ•°ã€‚

#### 13.2.1 **Set è¿­ä»£ï¼ˆiterationï¼‰**:

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `for..of` æˆ– `forEach` æ¥éå† Setï¼š

```javascript
let set = new Set(["oranges", "apples", "bananas"]);

for (let value of set) alert(value);

// ä¸ forEach ç›¸åŒï¼š
set.forEach((value, valueAgain, set) => {
  alert(value);
});
```

- `set.keys()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å€¼ï¼ˆreturns an iterable object for valuesï¼‰ï¼Œ
- `set.values()` â€”â€” ä¸ `set.keys()` ä½œç”¨ç›¸åŒï¼Œè¿™æ˜¯ä¸ºäº†å…¼å®¹ `Map`ï¼Œ
- `set.entries()` â€”â€” éå†å¹¶è¿”å›æ‰€æœ‰çš„å®ä½“ï¼ˆreturns an iterable object for entriesï¼‰`[value, value]`ï¼Œå®ƒçš„å­˜åœ¨ä¹Ÿæ˜¯ä¸ºäº†å…¼å®¹ `Map`ã€‚



## 14. è§£æ„èµ‹å€¼

**è§£æ„èµ‹å€¼** æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ï¼Œå®ƒä½¿æˆ‘ä»¬å¯ä»¥å°†æ•°ç»„æˆ–å¯¹è±¡â€œæ‹†åŒ…â€è‡³ä¸€ç³»åˆ—å˜é‡ä¸­

### 14.1 **æ•°ç»„è§£æ„**

~~~javascript
// æˆ‘ä»¬æœ‰ä¸€ä¸ªå­˜æ”¾äº†åå­—å’Œå§“æ°çš„æ•°ç»„
let arr = ["John", "Smith"]

// è§£æ„èµ‹å€¼
// sets firstName = arr[0]
// and surname = arr[1]
let [firstName, surname] = arr;

alert(firstName); // John
alert(surname);  // Smith
~~~

- **ç­‰å·å³ä¾§å¯ä»¥æ˜¯ä»»ä½•å¯è¿­ä»£å¯¹è±¡**

  â€¦å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸ä»»ä½•å¯è¿­ä»£å¯¹è±¡ä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸ä»…é™äºæ•°ç»„ï¼š

  ```javascript
  let [a, b, c] = "abc"; // ["a", "b", "c"]
  let [one, two, three] = new Set([1, 2, 3]);
  ```

  è¿™è¡Œå¾—é€šï¼Œå› ä¸ºåœ¨å†…éƒ¨ï¼Œè§£æ„èµ‹å€¼æ˜¯é€šè¿‡è¿­ä»£å³ä¾§çš„å€¼æ¥å®Œæˆå·¥ä½œçš„ã€‚è¿™æ˜¯ä¸€ç§ç”¨äºå¯¹åœ¨ `=` å³ä¾§çš„å€¼ä¸Šè°ƒç”¨ `for..of` å¹¶è¿›è¡Œèµ‹å€¼çš„æ“ä½œçš„è¯­æ³•ç³–ã€‚

- **èµ‹å€¼ç»™ç­‰å·å·¦ä¾§çš„ä»»ä½•å†…å®¹**

  æˆ‘ä»¬å¯ä»¥åœ¨ç­‰å·å·¦ä¾§ä½¿ç”¨ä»»ä½•â€œå¯ä»¥è¢«èµ‹å€¼çš„â€ä¸œè¥¿ã€‚

  ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼š

  ```javascript
  let user = {};
  [user.name, user.surname] = "John Smith".split(' ');
  
  alert(user.name); // John
  alert(user.surname); // Smith
  ```

- **å…¶ä½™çš„ â€˜â€¦â€™**

  å¦‚æœæˆ‘ä»¬è¿˜æƒ³æ”¶é›†å…¶ä½™çš„æ•°ç»„é¡¹ â€”â€” æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰ä¸ªç‚¹ `"..."` æ¥å†åŠ ä¸€ä¸ªå‚æ•°ä»¥è·å–â€œå…¶ä½™â€æ•°ç»„é¡¹ï¼š

  ```javascript
  let [name1, name2, ...rest] = ["Julius", "Caesar", "Consul", "of the Roman Republic"];
  
  // rest æ˜¯åŒ…å«ä»ç¬¬ä¸‰é¡¹å¼€å§‹çš„å…¶ä½™æ•°ç»„é¡¹çš„æ•°ç»„
  alert(rest[0]); // Consul
  alert(rest[1]); // of the Roman Republic
  alert(rest.length); // 2
  ```

- **é»˜è®¤å€¼**

  å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªâ€œé»˜è®¤â€å€¼ç»™æœªèµ‹å€¼çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `=` æ¥æä¾›ï¼š

  ```javascript
  // é»˜è®¤å€¼
  let [name = "Guest", surname = "Anonymous"] = ["Julius"];
  
  alert(name);    // Juliusï¼ˆæ¥è‡ªæ•°ç»„çš„å€¼ï¼‰
  alert(surname); // Anonymousï¼ˆé»˜è®¤å€¼è¢«ä½¿ç”¨äº†ï¼‰
  ```

### 14.2 **å¯¹è±¡è§£æ„**

```javascript
let {var1, var2} = {var1:â€¦, var2:â€¦}
```

å˜é‡çš„é¡ºåºå¹¶ä¸é‡è¦ï¼Œä¸‹é¢è¿™ä¸ªä»£ç ä¹Ÿå¥æ•ˆï¼š

```javascript
// æ”¹å˜ let {...} ä¸­å…ƒç´ çš„é¡ºåº
let {height, width, title} = { title: "Menu", height: 200, width: 100 }
```

å¦‚æœæˆ‘ä»¬æƒ³æŠŠä¸€ä¸ªå±æ€§èµ‹å€¼ç»™å¦ä¸€ä¸ªåå­—çš„å˜é‡ï¼Œæ¯”å¦‚æŠŠ `options.width` å±æ€§èµ‹å€¼ç»™åä¸º `w` çš„å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†’å·æ¥è®¾ç½®å˜é‡åç§°ï¼š

```javascript
let options = {
  title: "Menu",
  width: 100,
  height: 200
};

// { sourceProperty: targetVariable }
let {width: w, height: h, title} = options;

// width -> w
// height -> h
// title -> title

alert(title);  // Menu
alert(w);      // 100
alert(h);      // 200
```

å†’å·è¡¨ç¤ºâ€œä»€ä¹ˆå€¼ï¼šèµ‹å€¼ç»™è°â€ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå±æ€§ `width` è¢«èµ‹å€¼ç»™äº† `w`ï¼Œå±æ€§ `height` è¢«èµ‹å€¼ç»™äº† `h`ï¼Œå±æ€§ `title` è¢«èµ‹å€¼ç»™äº†åŒåå˜é‡ã€‚

å¯¹äºå¯èƒ½ç¼ºå¤±çš„å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `"="` è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```javascript
let options = {
  title: "Menu"
};

let {width = 100, height = 200, title} = options;

alert(title);  // Menu
alert(width);  // 100
alert(height); // 200
```

å°±åƒæ•°ç»„æˆ–å‡½æ•°å‚æ•°ä¸€æ ·ï¼Œé»˜è®¤å€¼å¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ç”šè‡³å¯ä»¥æ˜¯å‡½æ•°è°ƒç”¨ã€‚å®ƒä»¬åªä¼šåœ¨æœªæä¾›å¯¹åº”çš„å€¼æ—¶æ‰ä¼šè¢«è®¡ç®—/è°ƒç”¨ã€‚

### 14.3 **å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰"â€¦"**

å¦‚æœå¯¹è±¡æ‹¥æœ‰çš„å±æ€§æ•°é‡æ¯”æˆ‘ä»¬æä¾›çš„å˜é‡æ•°é‡è¿˜å¤šï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å¯ä»¥åªå–å…¶ä¸­çš„æŸä¸€äº›å±æ€§ï¼Œç„¶åæŠŠâ€œå‰©ä½™çš„â€èµ‹å€¼åˆ°å…¶ä»–åœ°æ–¹å—ï¼Ÿ

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰©ä½™æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå°±åƒæˆ‘ä»¬å¯¹æ•°ç»„é‚£æ ·ã€‚ä¸€äº›è¾ƒæ—§çš„æµè§ˆå™¨ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼ˆä¾‹å¦‚ IEï¼Œå¯ä»¥ä½¿ç”¨ Babel å¯¹å…¶è¿›è¡Œ polyfillï¼‰ï¼Œä½†å¯ä»¥åœ¨ç°ä»£æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚

çœ‹èµ·æ¥å°±åƒè¿™æ ·ï¼š

```javascript
let options = {
  title: "Menu",
  height: 200,
  width: 100
};

// title = åä¸º title çš„å±æ€§
// rest = å­˜æœ‰å‰©ä½™å±æ€§çš„å¯¹è±¡
let {title, ...rest} = options;

// ç°åœ¨ title="Menu", rest={height: 200, width: 100}
alert(rest.height);  // 200
alert(rest.width);   // 100
```



## 15. JSON æ–¹æ³•

JavaScript æä¾›äº†å¦‚ä¸‹æ–¹æ³•ï¼š

- `JSON.stringify` å°†å¯¹è±¡è½¬æ¢ä¸º JSONã€‚

  ~~~javascript
  let json = JSON.stringify(value[, replacer, space])
  ~~~

  `value`ï¼šè¦ç¼–ç çš„å€¼ã€‚

  `replacer`ï¼šè¦ç¼–ç çš„å±æ€§æ•°ç»„æˆ–æ˜ å°„å‡½æ•° `function(key, value)`ã€‚

  `space`ï¼šç”¨äºæ ¼å¼åŒ–çš„ç©ºæ ¼æ•°é‡

  ~~~javascript
  let room = {
    number: 23
  };
  
  let meetup = {
    title: "Conference",
    participants: [{name: "John"}, {name: "Alice"}],
    place: room // meetup å¼•ç”¨äº† room
  };
  
  room.occupiedBy = meetup; // room å¼•ç”¨äº† meetup
  
  alert( JSON.stringify(meetup, ['title', 'participants']) );
  // {"title":"Conference","participants":[{},{}]}
  ~~~

- `JSON.parse` å°† JSON è½¬æ¢å›å¯¹è±¡ã€‚

  ~~~javascript
  let value = JSON.parse(str, [reviver]);
  ~~~

  `str`ï¼šè¦è§£æçš„ JSON å­—ç¬¦ä¸²ã€‚

  `reviver`ï¼šå¯é€‰çš„å‡½æ•° function(key,value)ï¼Œè¯¥å‡½æ•°å°†ä¸ºæ¯ä¸ª `(key, value)` å¯¹è°ƒç”¨ï¼Œå¹¶å¯ä»¥å¯¹å€¼è¿›è¡Œè½¬æ¢ã€‚



## 16. Rest å‚æ•°ä¸ Spread è¯­æ³•

### 16.1 **Rest å‚æ•° `...`**

åœ¨ JavaScript ä¸­ï¼Œæ— è®ºå‡½æ•°æ˜¯å¦‚ä½•å®šä¹‰çš„ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨ä»»æ„æ•°é‡çš„å‚æ•°è°ƒç”¨å‡½æ•°ã€‚

```javascript
function sumAll(...args) { // æ•°ç»„åä¸º args
  let sum = 0;

  for (let arg of args) sum += arg;

  return sum;
}

alert( sumAll(1) ); // 1
alert( sumAll(1, 2) ); // 3
alert( sumAll(1, 2, 3) ); // 6
```

### 16.2 **Spread è¯­æ³•**

Spread è¯­æ³•åªé€‚ç”¨äºå¯è¿­ä»£å¯¹è±¡ã€‚

**Spread è¯­æ³•** æ¥å¸®åŠ©ä½ äº†ï¼å®ƒçœ‹èµ·æ¥å’Œ rest å‚æ•°å¾ˆåƒï¼Œä¹Ÿä½¿ç”¨ `...`ï¼Œä½†æ˜¯äºŒè€…çš„ç”¨é€”å®Œå…¨ç›¸åã€‚

å½“åœ¨å‡½æ•°è°ƒç”¨ä¸­ä½¿ç”¨ `...arr` æ—¶ï¼Œå®ƒä¼šæŠŠå¯è¿­ä»£å¯¹è±¡ `arr` â€œå±•å¼€â€åˆ°å‚æ•°åˆ—è¡¨ä¸­ã€‚

ä»¥ `Math.max` ä¸ºä¾‹ï¼š

```javascript
let arr = [3, 5, 1];
alert( Math.max(...arr) ); // 5ï¼ˆspread è¯­æ³•æŠŠæ•°ç»„è½¬æ¢ä¸ºå‚æ•°åˆ—è¡¨ï¼‰

let obj = { a: 1, b: 2, c: 3 };
let objCopy = { ...obj }; // å°†å¯¹è±¡ spread åˆ°å‚æ•°åˆ—è¡¨ä¸­
                          // ç„¶åå°†ç»“æœè¿”å›åˆ°ä¸€ä¸ªæ–°å¯¹è±¡
```

å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­çœ‹åˆ° `"..."` æ—¶ï¼Œå®ƒè¦ä¹ˆæ˜¯ rest å‚æ•°ï¼Œè¦ä¹ˆå°±æ˜¯ spread è¯­æ³•ã€‚

æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•å¯ä»¥åŒºåˆ†å®ƒä»¬ï¼š

- è‹¥ `...` å‡ºç°åœ¨å‡½æ•°å‚æ•°åˆ—è¡¨çš„æœ€åï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ rest å‚æ•°ï¼Œå®ƒä¼šæŠŠå‚æ•°åˆ—è¡¨ä¸­å‰©ä½™çš„å‚æ•°æ”¶é›†åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ã€‚
- è‹¥ `...` å‡ºç°åœ¨å‡½æ•°è°ƒç”¨æˆ–ç±»ä¼¼çš„è¡¨è¾¾å¼ä¸­ï¼Œé‚£å®ƒå°±æ˜¯ spread è¯­æ³•ï¼Œå®ƒä¼šæŠŠä¸€ä¸ªæ•°ç»„å±•å¼€ä¸ºåˆ—è¡¨ã€‚

ä½¿ç”¨åœºæ™¯ï¼š

- Rest å‚æ•°ç”¨äºåˆ›å»ºå¯æ¥å—ä»»æ„æ•°é‡å‚æ•°çš„å‡½æ•°ã€‚
- Spread è¯­æ³•ç”¨äºå°†æ•°ç»„ä¼ é€’ç»™é€šå¸¸éœ€è¦å«æœ‰è®¸å¤šå‚æ•°çš„åˆ—è¡¨çš„å‡½æ•°ã€‚

å®ƒä»¬ä¿©çš„å‡ºç°å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°åœ¨åˆ—è¡¨å’Œå‚æ•°æ•°ç»„ä¹‹é—´æ¥å›è½¬æ¢ã€‚

â€œæ—§å¼â€çš„ `arguments`ï¼ˆç±»æ•°ç»„ä¸”å¯è¿­ä»£çš„å¯¹è±¡ï¼‰ä¹Ÿä¾ç„¶èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬è·å–å‡½æ•°è°ƒç”¨ä¸­çš„æ‰€æœ‰å‚æ•°ã€‚



## 17. å‡½æ•°å¯¹è±¡

### 17.1 **å±æ€§ â€œnameâ€**

å‡½æ•°å¯¹è±¡åŒ…å«ä¸€äº›ä¾¿äºä½¿ç”¨çš„å±æ€§ã€‚

æ¯”å¦‚ï¼Œä¸€ä¸ªå‡½æ•°çš„åå­—å¯ä»¥é€šè¿‡å±æ€§ â€œnameâ€ æ¥è®¿é—®ï¼š

```javascript
function sayHi() {
  alert("Hi");
}

alert(sayHi.name); // sayHi
```

### 17.2 **å±æ€§ â€œlengthâ€**

è¿˜æœ‰å¦ä¸€ä¸ªå†…å»ºå±æ€§ â€œlengthâ€ï¼Œå®ƒè¿”å›å‡½æ•°å…¥å‚çš„ä¸ªæ•°ï¼Œæ¯”å¦‚ï¼š

```javascript
function f1(a) {}
function f2(a, b) {}
function many(a, b, ...more) {}

alert(f1.length); // 1
alert(f2.length); // 2
alert(many.length); // 2
```

å¯ä»¥çœ‹åˆ°ï¼Œrest å‚æ•°ä¸å‚ä¸è®¡æ•°ã€‚

### 17.3 **è‡ªå®šä¹‰å±æ€§**

æˆ‘ä»¬ä¹Ÿå¯ä»¥æ·»åŠ æˆ‘ä»¬è‡ªå·±çš„å±æ€§ã€‚

è¿™é‡Œæˆ‘ä»¬æ·»åŠ äº† `counter` å±æ€§ï¼Œç”¨æ¥è·Ÿè¸ªæ€»çš„è°ƒç”¨æ¬¡æ•°ï¼š

```javascript
function sayHi() {
  alert("Hi");

  // è®¡ç®—è°ƒç”¨æ¬¡æ•°
  sayHi.counter++;
}
sayHi.counter = 0; // åˆå§‹å€¼

sayHi(); // Hi
sayHi(); // Hi

alert( `Called ${sayHi.counter} times` ); // Called 2 times
```



## 18. è£…é¥°å™¨æ¨¡å¼å’Œè½¬å‘

> callã€applyã€bindéƒ½å¯ä»¥æ”¹å˜å‡½æ•°çš„thisæŒ‡å‘ï¼Œä½†callå’Œapplyä¼šç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œbindä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°è€Œæ˜¯è¿”å›æ–°å‡½æ•°ã€‚

### 18.1 call

~~~javascript
func.call(context, arg1, arg2, ...)
~~~

å®ƒè¿è¡Œ `func`ï¼Œæä¾›çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸º `this`ï¼Œåé¢çš„ä½œä¸ºå‚æ•°ï¼ˆargumentsï¼‰

~~~javascript
function sayHi() {
  alert(this.name);
}

let user = { name: "John" };
let admin = { name: "Admin" };

// ä½¿ç”¨ call å°†ä¸åŒçš„å¯¹è±¡ä¼ é€’ä¸º "this"
sayHi.call( user ); // John
sayHi.call( admin ); // Admin
~~~

### 18.2 **apply**

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `func.apply(this, arguments)` ä»£æ›¿ `func.call(this, ...arguments)`ã€‚

~~~javascript
func.apply(context, args)
~~~

å®ƒè¿è¡Œ `func` è®¾ç½® `this=context`ï¼Œå¹¶ä½¿ç”¨ç±»æ•°ç»„å¯¹è±¡ `args`æ˜¯ä¸€ä¸ªåˆ—è¡¨æ•°ç»„ä½œä¸ºå‚æ•°åˆ—è¡¨ï¼ˆargumentsï¼‰ã€‚

- `call` å’Œ `apply` ä¹‹é—´å”¯ä¸€çš„è¯­æ³•åŒºåˆ«æ˜¯ï¼Œ`call` æœŸæœ›ä¸€ä¸ªå‚æ•°åˆ—è¡¨ï¼Œè€Œ `apply` æœŸæœ›ä¸€ä¸ªåŒ…å«è¿™äº›å‚æ•°çš„ç±»æ•°ç»„å¯¹è±¡ã€‚

- `apply` åªæ¥å— **ç±»æ•°ç»„**ã€‚

### 18.3 bind

åŸºæœ¬çš„è¯­æ³•æ˜¯ï¼š

```javascript
// ç¨åå°†ä¼šæœ‰æ›´å¤æ‚çš„è¯­æ³•
let boundFunc = func.bind(context);
```

æ”¹å˜`func`å‡½æ•°çš„thisæŒ‡å‘ï¼Œå¹¶æ”¾å›ä¸€ä¸ªæ–°çš„å‡½æ•°è¿›è¡Œè°ƒç”¨ã€‚

æˆ‘ä»¬ä¸ä»…å¯ä»¥ç»‘å®š `this`ï¼Œè¿˜å¯ä»¥ç»‘å®šå‚æ•°ï¼ˆargumentsï¼‰ã€‚è™½ç„¶å¾ˆå°‘è¿™ä¹ˆåšï¼Œä½†æœ‰æ—¶å®ƒå¯ä»¥æ´¾ä¸Šç”¨åœºã€‚

`bind` çš„å®Œæ•´è¯­æ³•å¦‚ä¸‹ï¼š

```javascript
let bound = func.bind(context, [arg1], [arg2], ...);
```

```javascript
function mul(a, b) {
  return a * b;
}

let double = mul.bind(null, 2);

alert( double(3) ); // = mul(2, 3) = 6
alert( double(4) ); // = mul(2, 4) = 8
alert( double(5) ); // = mul(2, 5) = 10
```

å¯¹ `mul.bind(null, 2)` çš„è°ƒç”¨åˆ›å»ºäº†ä¸€ä¸ªæ–°å‡½æ•° `double`ï¼Œå®ƒå°†è°ƒç”¨ä¼ é€’åˆ° `mul`ï¼Œå°† `null` ç»‘å®šä¸ºä¸Šä¸‹æ–‡ï¼Œå¹¶å°† `2` ç»‘å®šä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚å¹¶ä¸”ï¼Œå‚æ•°ï¼ˆargumentsï¼‰å‡è¢«â€œåŸæ ·â€ä¼ é€’ã€‚

## 19. å±æ€§æ ‡å¿—å’Œå±æ€§æè¿°ç¬¦

### 19.1 **å±æ€§æ ‡å¿—**ï¼š

å¯¹è±¡å±æ€§ï¼ˆpropertiesï¼‰ï¼Œé™¤ **`value`** å¤–ï¼Œè¿˜æœ‰ä¸‰ä¸ªç‰¹æ®Šçš„ç‰¹æ€§ï¼ˆattributesï¼‰ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„â€œæ ‡å¿—â€ï¼š

- **`writable`** â€” å¦‚æœä¸º `true`ï¼Œåˆ™å€¼å¯ä»¥è¢«ä¿®æ”¹ï¼Œå¦åˆ™å®ƒæ˜¯åªå¯è¯»çš„ã€‚
- **`enumerable`** â€” å¦‚æœä¸º `true`ï¼Œåˆ™ä¼šè¢«åœ¨å¾ªç¯ä¸­åˆ—å‡ºï¼Œå¦åˆ™ä¸ä¼šè¢«åˆ—å‡ºã€‚
- **`configurable`** â€” å¦‚æœä¸º `true`ï¼Œåˆ™æ­¤å±æ€§å¯ä»¥è¢«åˆ é™¤ï¼Œè¿™äº›ç‰¹æ€§ä¹Ÿå¯ä»¥è¢«ä¿®æ”¹ï¼Œå¦åˆ™ä¸å¯ä»¥ã€‚

å½“æˆ‘ä»¬ç”¨â€œå¸¸ç”¨çš„æ–¹å¼â€åˆ›å»ºä¸€ä¸ªå±æ€§æ—¶ï¼Œå®ƒä»¬éƒ½ä¸º `true`ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥éšæ—¶æ›´æ”¹å®ƒä»¬ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è·å¾—è¿™äº›æ ‡å¿—ã€‚

### 19.2 getOwnPropertyDescriptor

æ–¹æ³•å…è®¸æŸ¥è¯¢æœ‰å…³å±æ€§çš„ **å®Œæ•´** ä¿¡æ¯ã€‚

è¯­æ³•æ˜¯ï¼š

```javascript
let descriptor = Object.getOwnPropertyDescriptor(obj, propertyName);
```

- `obj`

  éœ€è¦ä»ä¸­è·å–ä¿¡æ¯çš„å¯¹è±¡ã€‚

- `propertyName`

  å±æ€§çš„åç§°ã€‚

è¿”å›å€¼æ˜¯ä¸€ä¸ªæ‰€è°“çš„â€œå±æ€§æè¿°ç¬¦â€å¯¹è±¡ï¼šå®ƒåŒ…å«å€¼å’Œæ‰€æœ‰çš„æ ‡å¿—ã€‚

ä¾‹å¦‚ï¼š

```javascript
let user = {
  name: "John"
};

let descriptor = Object.getOwnPropertyDescriptor(user, 'name');
```

### 19.3 defineProperty

ä¿®æ”¹æ ‡å¿—

è¯­æ³•æ˜¯ï¼š

```javascript
Object.defineProperty(obj, propertyName, descriptor)
```

- `obj`ï¼Œ`propertyName`

  è¦åº”ç”¨æè¿°ç¬¦çš„å¯¹è±¡åŠå…¶å±æ€§ã€‚

- `descriptor`

  è¦åº”ç”¨çš„å±æ€§æè¿°ç¬¦å¯¹è±¡ã€‚

å¦‚æœè¯¥å±æ€§å­˜åœ¨ï¼Œ`defineProperty` ä¼šæ›´æ–°å…¶æ ‡å¿—ã€‚å¦åˆ™ï¼Œå®ƒä¼šä½¿ç”¨ç»™å®šçš„å€¼å’Œæ ‡å¿—åˆ›å»ºå±æ€§ï¼›åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰æä¾›æ ‡å¿—ï¼Œåˆ™ä¼šå‡å®šå®ƒæ˜¯ `false`ã€‚

ä¾‹å¦‚ï¼Œè¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªå±æ€§ `name`ï¼Œè¯¥å±æ€§çš„æ‰€æœ‰æ ‡å¿—éƒ½ä¸º `false`ï¼š

```javascript
let user = {};

Object.defineProperty(user, "name", {
  value: "John"
});

let descriptor = Object.getOwnPropertyDescriptor(user, 'name');

alert( JSON.stringify(descriptor, null, 2 ) );
/*
{
  "value": "John",
  "writable": false,
  "enumerable": false,
  "configurable": false
}
 */
```

### 19.4 **è®¾å®šä¸€ä¸ªå…¨å±€çš„å¯†å°å¯¹è±¡**ï¼š

å±æ€§æè¿°ç¬¦åœ¨å•ä¸ªå±æ€§çš„çº§åˆ«ä¸Šå·¥ä½œã€‚

è¿˜æœ‰ä¸€äº›é™åˆ¶è®¿é—® **æ•´ä¸ª** å¯¹è±¡çš„æ–¹æ³•ï¼š

- [Object.preventExtensions(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/preventExtensions)

  ç¦æ­¢å‘å¯¹è±¡æ·»åŠ æ–°å±æ€§ã€‚

- [Object.seal(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/seal)

  ç¦æ­¢æ·»åŠ /åˆ é™¤å±æ€§ã€‚ä¸ºæ‰€æœ‰ç°æœ‰çš„å±æ€§è®¾ç½® `configurable: false`ã€‚

- [Object.freeze(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)

  ç¦æ­¢æ·»åŠ /åˆ é™¤/æ›´æ”¹å±æ€§ã€‚ä¸ºæ‰€æœ‰ç°æœ‰çš„å±æ€§è®¾ç½® `configurable: false, writable: false`ã€‚

- [Object.isExtensible(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isExtensible)

  å¦‚æœæ·»åŠ å±æ€§è¢«ç¦æ­¢ï¼Œåˆ™è¿”å› `false`ï¼Œå¦åˆ™è¿”å› `true`ã€‚

- [Object.isSealed(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isSealed)

  å¦‚æœæ·»åŠ /åˆ é™¤å±æ€§è¢«ç¦æ­¢ï¼Œå¹¶ä¸”æ‰€æœ‰ç°æœ‰çš„å±æ€§éƒ½å…·æœ‰ `configurable: false`åˆ™è¿”å› `true`ã€‚

- [Object.isFrozen(obj)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isFrozen)

  å¦‚æœæ·»åŠ /åˆ é™¤/æ›´æ”¹å±æ€§è¢«ç¦æ­¢ï¼Œå¹¶ä¸”æ‰€æœ‰å½“å‰å±æ€§éƒ½æ˜¯ `configurable: false, writable: false`ï¼Œåˆ™è¿”å› `true`ã€‚

### 19.5 å±æ€§çš„ getter å’Œ setter

**getter å’Œ setter**ï¼š

è®¿é—®å™¨å±æ€§ç”± â€œgetterâ€ å’Œ â€œsetterâ€ æ–¹æ³•è¡¨ç¤ºã€‚åœ¨å¯¹è±¡å­—é¢é‡ä¸­ï¼Œå®ƒä»¬ç”¨ `get` å’Œ `set` è¡¨ç¤ºï¼š

```javascript
let obj = {
  get propName() {
    // å½“è¯»å– obj.propName æ—¶ï¼Œgetter èµ·ä½œç”¨
  },

  set propName(value) {
    // å½“æ‰§è¡Œ obj.propName = value æ“ä½œæ—¶ï¼Œsetter èµ·ä½œç”¨
  }
};
```

å½“è¯»å– `obj.propName` æ—¶ï¼Œgetter èµ·ä½œç”¨ï¼Œå½“ `obj.propName` è¢«èµ‹å€¼æ—¶ï¼Œsetter èµ·ä½œç”¨ã€‚

### 19.6 **è®¿é—®å™¨æè¿°ç¬¦**

è®¿é—®å™¨å±æ€§çš„æè¿°ç¬¦ä¸æ•°æ®å±æ€§çš„ä¸åŒã€‚

å¯¹äºè®¿é—®å™¨å±æ€§ï¼Œæ²¡æœ‰ `value` å’Œ `writable`ï¼Œä½†æ˜¯æœ‰ `get` å’Œ `set` å‡½æ•°ã€‚

æ‰€ä»¥è®¿é—®å™¨æè¿°ç¬¦å¯èƒ½æœ‰ï¼š

- **`get`** â€”â€” ä¸€ä¸ªæ²¡æœ‰å‚æ•°çš„å‡½æ•°ï¼Œåœ¨è¯»å–å±æ€§æ—¶å·¥ä½œï¼Œ
- **`set`** â€”â€” å¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ï¼Œå½“å±æ€§è¢«è®¾ç½®æ—¶è°ƒç”¨ï¼Œ
- **`enumerable`** â€”â€” ä¸æ•°æ®å±æ€§çš„ç›¸åŒï¼Œ
- **`configurable`** â€”â€” ä¸æ•°æ®å±æ€§çš„ç›¸åŒã€‚

ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨ `defineProperty` åˆ›å»ºä¸€ä¸ª `fullName` è®¿é—®å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `get` å’Œ `set` æ¥ä¼ é€’æè¿°ç¬¦ï¼š

```javascript
let user = {
  name: "John",
  surname: "Smith"
};

Object.defineProperty(user, 'fullName', {
  get() {
    return `${this.name} ${this.surname}`;
  },

  set(value) {
    [this.name, this.surname] = value.split(" ");
  }
});

alert(user.fullName); // John Smith

for(let key in user) alert(key); // name, surname
```

è¯·æ³¨æ„ï¼Œä¸€ä¸ªå±æ€§è¦ä¹ˆæ˜¯è®¿é—®å™¨ï¼ˆå…·æœ‰ `get/set` æ–¹æ³•ï¼‰ï¼Œè¦ä¹ˆæ˜¯æ•°æ®å±æ€§ï¼ˆå…·æœ‰ `value`ï¼‰ï¼Œä½†ä¸èƒ½ä¸¤è€…éƒ½æ˜¯ã€‚

å¦‚æœæˆ‘ä»¬è¯•å›¾åœ¨åŒä¸€ä¸ªæè¿°ç¬¦ä¸­åŒæ—¶æä¾› `get` å’Œ `value`ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ï¼š

```javascript
// Error: Invalid property descriptor.
Object.defineProperty({}, 'prop', {
  get() {
    return 1
  },

  value: 2
});
```

## 22. Generatorï¼Œé«˜çº§ iteration

**Generator å‡½æ•°**ï¼š

è€Œ Generator å¯ä»¥æŒ‰éœ€ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿”å›ï¼ˆâ€œyieldâ€ï¼‰å¤šä¸ªå€¼ã€‚å®ƒä»¬å¯ä¸ [iterable](https://zh.javascript.info/iterable) å®Œç¾é…åˆä½¿ç”¨ï¼Œä»è€Œå¯ä»¥è½»æ¾åœ°åˆ›å»ºæ•°æ®æµã€‚

è¦åˆ›å»ºä¸€ä¸ª generatorï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•ç»“æ„ï¼š`function*`ï¼Œå³æ‰€è°“çš„ â€œgenerator functionâ€ã€‚

å®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```javascript
function* generateSequence() {
  yield 1;
  yield 2;
  return 3;
}
```

Generator å‡½æ•°ä¸å¸¸è§„å‡½æ•°çš„è¡Œä¸ºä¸åŒã€‚åœ¨æ­¤ç±»å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¸ä¼šè¿è¡Œå…¶ä»£ç ã€‚è€Œæ˜¯è¿”å›ä¸€ä¸ªè¢«ç§°ä¸º â€œgenerator objectâ€ çš„ç‰¹æ®Šå¯¹è±¡ï¼Œæ¥ç®¡ç†æ‰§è¡Œæµç¨‹ã€‚

ä¸€ä¸ª generator çš„ä¸»è¦æ–¹æ³•å°±æ˜¯ `next()`

`next()` çš„ç»“æœå§‹ç»ˆæ˜¯ä¸€ä¸ªå…·æœ‰ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼š

- `value`: äº§å‡ºçš„ï¼ˆyieldedï¼‰çš„å€¼ã€‚
- `done`: å¦‚æœ generator å‡½æ•°å·²æ‰§è¡Œå®Œæˆåˆ™ä¸º `true`ï¼Œå¦åˆ™ä¸º `false`ã€‚

generator æ˜¯ `å¯è¿­ä»£`çš„

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `for..of` å¾ªç¯éå†å®ƒæ‰€æœ‰çš„å€¼ï¼š

```javascript
function* generateSequence() {
  yield 1;
  yield 2;
  return 3;
}

let generator = generateSequence();

for(let value of generator) {
  alert(value); // 1ï¼Œç„¶åæ˜¯ 2
}
```



## 23. æ¨¡å—

æ¨¡å—å¯ä»¥ç›¸äº’åŠ è½½ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„æŒ‡ä»¤ `export` å’Œ `import` æ¥äº¤æ¢åŠŸèƒ½ï¼Œä»å¦ä¸€ä¸ªæ¨¡å—è°ƒç”¨ä¸€ä¸ªæ¨¡å—çš„å‡½æ•°ï¼š

- `export` å…³é”®å­—æ ‡è®°äº†å¯ä»¥ä»å½“å‰æ¨¡å—å¤–éƒ¨è®¿é—®çš„å˜é‡å’Œå‡½æ•°ã€‚
- `import` å…³é”®å­—å…è®¸ä»å…¶ä»–æ¨¡å—å¯¼å…¥åŠŸèƒ½ã€‚

ç”±äºæ¨¡å—æ”¯æŒç‰¹æ®Šçš„å…³é”®å­—å’ŒåŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»é€šè¿‡ä½¿ç”¨ `<script type="module">` ç‰¹æ€§ï¼ˆattributeï¼‰æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œæ­¤è„šæœ¬åº”è¯¥è¢«å½“ä½œæ¨¡å—ï¼ˆmoduleï¼‰æ¥å¯¹å¾…ã€‚

**æ¨¡å—åªé€šè¿‡ HTTP(s) å·¥ä½œï¼Œè€Œéæœ¬åœ°**

å¦‚æœä½ å°è¯•é€šè¿‡ `file://` åè®®åœ¨æœ¬åœ°æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œä½ ä¼šå‘ç° `import/export` æŒ‡ä»¤ä¸èµ·ä½œç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨æœ¬åœ° Web æœåŠ¡å™¨ï¼Œä¾‹å¦‚ [static-server](https://www.npmjs.com/package/static-server#getting-started)ï¼Œæˆ–è€…ä½¿ç”¨ç¼–è¾‘å™¨çš„â€œå®æ—¶æœåŠ¡å™¨â€åŠŸèƒ½ï¼Œä¾‹å¦‚ VS Code çš„ [Live Server Extension](https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer) æ¥æµ‹è¯•æ¨¡å—ã€‚

å¦‚æœåŒä¸€ä¸ªæ¨¡å—è¢«å¯¼å…¥åˆ°å¤šä¸ªå…¶ä»–ä½ç½®ï¼Œé‚£ä¹ˆå®ƒçš„ä»£ç åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå³åœ¨ç¬¬ä¸€æ¬¡è¢«å¯¼å…¥æ—¶ã€‚ç„¶åå°†å…¶å¯¼å‡ºï¼ˆexportï¼‰çš„å†…å®¹æä¾›ç»™è¿›ä¸€æ­¥çš„å¯¼å…¥ï¼ˆimporterï¼‰ã€‚

å¦‚æœè¿™ä¸ªæ¨¡å—è¢«å¯¼å…¥åˆ°å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œæ¨¡å—ä»…åœ¨ç¬¬ä¸€æ¬¡è¢«å¯¼å…¥æ—¶è¢«è§£æï¼Œå¹¶åˆ›å»º `admin` å¯¹è±¡ï¼Œç„¶åå°†å…¶ä¼ å…¥åˆ°æ‰€æœ‰çš„å¯¼å…¥ã€‚

æ‰€æœ‰çš„å¯¼å…¥éƒ½åªè·å¾—äº†ä¸€ä¸ªå”¯ä¸€çš„ `admin` å¯¹è±¡ï¼š

```javascript
// ğŸ“ 1.js
import { admin } from './admin.js';
admin.name = "Pete";

// ğŸ“ 2.js
import { admin } from './admin.js';
alert(admin.name); // Pete

// 1.js å’Œ 2.js å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ª admin å¯¹è±¡
// åœ¨ 1.js ä¸­å¯¹å¯¹è±¡åšçš„æ›´æ”¹ï¼Œåœ¨ 2.js ä¸­ä¹Ÿæ˜¯å¯è§çš„
```

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå½“åœ¨ `1.js` ä¸­ä¿®æ”¹äº†å¯¼å…¥çš„ `admin` ä¸­çš„ `name` å±æ€§æ—¶ï¼Œæˆ‘ä»¬åœ¨ `2.js` ä¸­å¯ä»¥çœ‹åˆ°æ–°çš„ `admin.name`ã€‚

è¿™æ­£æ˜¯å› ä¸ºè¯¥æ¨¡å—åªæ‰§è¡Œäº†ä¸€æ¬¡ã€‚ç”Ÿæˆå¯¼å‡ºï¼Œç„¶åè¿™äº›å¯¼å‡ºåœ¨å¯¼å…¥ä¹‹é—´å…±äº«ï¼Œå› æ­¤å¦‚æœæ›´æ”¹äº† `admin` å¯¹è±¡ï¼Œåœ¨å…¶ä»–å¯¼å…¥ä¸­ä¹Ÿä¼šçœ‹åˆ°ã€‚

`import.meta` å¯¹è±¡åŒ…å«å…³äºå½“å‰æ¨¡å—çš„ä¿¡æ¯ã€‚

å®ƒçš„å†…å®¹å–å†³äºå…¶æ‰€åœ¨çš„ç¯å¢ƒã€‚åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œå®ƒåŒ…å«å½“å‰è„šæœ¬çš„ URLï¼Œæˆ–è€…å¦‚æœå®ƒæ˜¯åœ¨ HTML ä¸­çš„è¯ï¼Œåˆ™åŒ…å«å½“å‰é¡µé¢çš„ URLã€‚

```markup
<script type="module">
  alert(import.meta.url); // è„šæœ¬çš„ URLï¼ˆå¯¹äºå†…è”è„šæœ¬æ¥è¯´ï¼Œåˆ™æ˜¯å½“å‰ HTML é¡µé¢çš„ URLï¼‰
</script>
```

åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œé¡¶çº§ `this` æ˜¯ undefinedã€‚

å°†å…¶ä¸éæ¨¡å—è„šæœ¬è¿›è¡Œæ¯”è¾ƒä¼šå‘ç°ï¼Œéæ¨¡å—è„šæœ¬çš„é¡¶çº§ `this` æ˜¯å…¨å±€å¯¹è±¡ï¼š

```markup
<script>
  alert(this); // window
</script>

<script type="module">
  alert(this); // undefined
</script>
```

 `async`å¯¹äºæ¨¡å—è„šæœ¬ï¼Œå®ƒä¹Ÿé€‚ç”¨äºå†…è”è„šæœ¬ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢çš„å†…è”è„šæœ¬å…·æœ‰ `async` ç‰¹æ€§ï¼Œå› æ­¤å®ƒä¸ä¼šç­‰å¾…ä»»ä½•ä¸œè¥¿ã€‚

```javascript
<!-- æ‰€æœ‰ä¾èµ–éƒ½è·å–å®Œæˆï¼ˆanalytics.jsï¼‰ç„¶åè„šæœ¬å¼€å§‹è¿è¡Œ -->
<!-- ä¸ä¼šç­‰å¾… HTML æ–‡æ¡£æˆ–è€…å…¶ä»– <script> æ ‡ç­¾ -->
<script async type="module">
  import {counter} from './analytics.js';

  counter.count();
</script>
```



### 23.1 å¯¼å‡ºå’Œå¯¼å…¥

å¯¼å‡ºï¼ˆexportï¼‰å’Œå¯¼å…¥ï¼ˆimportï¼‰æŒ‡ä»¤æœ‰å‡ ç§è¯­æ³•å˜ä½“ã€‚

è¯·è®°ä½ï¼Œ`import` å‘½åçš„å¯¼å‡ºæ—¶éœ€è¦èŠ±æ‹¬å·ï¼Œè€Œ `import` é»˜è®¤çš„å¯¼å‡ºæ—¶ä¸éœ€è¦èŠ±æ‹¬å·ã€‚

ä½ å¯ä»¥é˜…è¯»å¹¶å›å¿†å®ƒä»¬çš„å«ä¹‰æ¥è¿›è¡Œè‡ªæŸ¥ï¼š

- åœ¨å£°æ˜ä¸€ä¸ª class/function/â€¦ ä¹‹å‰ï¼š
  - `export [default] class/function/variable ...`
- ç‹¬ç«‹çš„å¯¼å‡ºï¼š
  - `export {x [as y], ...}`.
- é‡æ–°å¯¼å‡ºï¼š
  - `export {x [as y], ...} from "module"`
  - `export * from "module"`ï¼ˆä¸ä¼šé‡æ–°å¯¼å‡ºé»˜è®¤çš„å¯¼å‡ºï¼‰ã€‚
  - `export {default [as y]} from "module"`ï¼ˆé‡æ–°å¯¼å‡ºé»˜è®¤çš„å¯¼å‡ºï¼‰ã€‚

å¯¼å…¥ï¼š

- å¯¼å…¥å‘½åçš„å¯¼å‡ºï¼š
  - `import {x [as y], ...} from "module"`
- å¯¼å…¥é»˜è®¤çš„å¯¼å‡ºï¼š
  - `import x from "module"`
  - `import {default as x} from "module"`
- å¯¼å…¥æ‰€æœ‰ï¼š
  - `import * as obj from "module"`
- å¯¼å…¥æ¨¡å—ï¼ˆå…¶ä»£ç ï¼Œå¹¶è¿è¡Œï¼‰ï¼Œä½†ä¸è¦å°†å…¶ä»»ä½•å¯¼å‡ºèµ‹å€¼ç»™å˜é‡ï¼š
  - `import "module"`

### 23.2 åŠ¨æ€å¯¼å…¥

**import() è¡¨è¾¾å¼**ï¼š

`import(module)` è¡¨è¾¾å¼åŠ è½½æ¨¡å—å¹¶è¿”å›ä¸€ä¸ª promiseï¼Œè¯¥ promise resolve ä¸ºä¸€ä¸ªåŒ…å«å…¶æ‰€æœ‰å¯¼å‡ºçš„æ¨¡å—å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»æ„ä½ç½®è°ƒç”¨è¿™ä¸ªè¡¨è¾¾å¼ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»æ„ä½ç½®åŠ¨æ€åœ°ä½¿ç”¨å®ƒã€‚ä¾‹å¦‚ï¼š

```javascript
let modulePath = prompt("Which module to load?");

import(modulePath)
  .then(obj => <module object>)
  .catch(err => <loading error, e.g. if no such module>)
```

æˆ–è€…ï¼Œå¦‚æœåœ¨å¼‚æ­¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `let module = await import(modulePath)`ã€‚

## 24. æ‚é¡¹

### 24.1 **Proxy**

ä»£ç†æä¾›äº†ä¸€ç§ç‹¬ç‰¹çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨æœ€åº•å±‚æ›´æ”¹æˆ–è°ƒæ•´ç°æœ‰å¯¹è±¡çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒå¹¶ä¸å®Œç¾ã€‚æœ‰å±€é™æ€§ã€‚

å¯¹åŸå‹å¯¹è±¡è¿›è¡Œä»£ç†ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡æ“ä½œåŸå§‹å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿›è¡Œæ“ä½œåŸå§‹å¯¹è±¡å‰è¿›è¡Œä¸€ç³»åˆ—å…¶ä»–æ“ä½œã€‚

ä»£ç†å’ŒåŸå§‹å¯¹è±¡æ˜¯ä¸åŒçš„å¯¹è±¡ã€‚

è¯­æ³•ï¼š

```javascript
let proxy = new Proxy(target, handler)
```

- `target` â€”â€” æ˜¯è¦åŒ…è£…çš„å¯¹è±¡ï¼Œå¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ï¼ŒåŒ…æ‹¬å‡½æ•°ã€‚

- `handler` â€”â€” ä»£ç†é…ç½®ï¼šå¸¦æœ‰â€œæ•æ‰å™¨â€ï¼ˆâ€œtrapsâ€ï¼Œå³æ‹¦æˆªæ“ä½œçš„æ–¹æ³•ï¼‰çš„å¯¹è±¡ã€‚æ¯”å¦‚ `get` æ•æ‰å™¨ç”¨äºè¯»å– `target` çš„å±æ€§ï¼Œ`set` æ•æ‰å™¨ç”¨äºå†™å…¥ `target` çš„å±æ€§ï¼Œç­‰ç­‰ã€‚

  | å†…éƒ¨æ–¹æ³•                | Handler æ–¹æ³•               | ä½•æ—¶è§¦å‘                                                     |
  | :---------------------- | :------------------------- | :----------------------------------------------------------- |
  | `[[Get]]`               | `get`                      | è¯»å–å±æ€§                                                     |
  | `[[Set]]`               | `set`                      | å†™å…¥å±æ€§                                                     |
  | `[[HasProperty]]`       | `has`                      | `in` æ“ä½œç¬¦                                                  |
  | `[[Delete]]`            | `deleteProperty`           | `delete` æ“ä½œç¬¦                                              |
  | `[[Call]]`              | `apply`                    | å‡½æ•°è°ƒç”¨                                                     |
  | `[[Construct]]`         | `construct`                | `new` æ“ä½œç¬¦                                                 |
  | `[[GetPrototypeOf]]`    | `getPrototypeOf`           | [Object.getPrototypeOf](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf) |
  | `[[SetPrototypeOf]]`    | `setPrototypeOf`           | [Object.setPrototypeOf](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/setPrototypeOf) |
  | `[[IsExtensible]]`      | `isExtensible`             | [Object.isExtensible](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/isExtensible) |
  | `[[PreventExtensions]]` | `preventExtensions`        | [Object.preventExtensions](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/preventExtensions) |
  | `[[DefineOwnProperty]]` | `defineProperty`           | [Object.defineProperty](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty), [Object.defineProperties](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperties) |
  | `[[GetOwnProperty]]`    | `getOwnPropertyDescriptor` | [Object.getOwnPropertyDescriptor](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor), `for..in`, `Object.keys/values/entries` |
  | `[[OwnPropertyKeys]]`   | `ownKeys`                  | [Object.getOwnPropertyNames](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames), [Object.getOwnPropertySymbols](https://developer.mozilla.org/zh/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertySymbols), `for..in`, `Object.keys/values/entries` |

  `get(target, property, receiver)` æ–¹æ³•ã€‚

  è¯»å–å±æ€§æ—¶è§¦å‘è¯¥æ–¹æ³•ï¼Œå‚æ•°å¦‚ä¸‹ï¼š

  - `target` â€”â€” æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¢«ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ `new Proxy`ï¼Œ

  - `property` â€”â€” ç›®æ ‡å±æ€§åï¼Œ

  - `receiver` â€”â€” å¦‚æœç›®æ ‡å±æ€§æ˜¯ä¸€ä¸ª getter è®¿é—®å™¨å±æ€§ï¼Œåˆ™ `receiver` å°±æ˜¯æœ¬æ¬¡è¯»å–å±æ€§æ‰€åœ¨çš„ `this` å¯¹è±¡ã€‚é€šå¸¸ï¼Œè¿™å°±æ˜¯ `proxy` å¯¹è±¡æœ¬èº«ï¼ˆæˆ–è€…ï¼Œå¦‚æœæˆ‘ä»¬ä» proxy ç»§æ‰¿ï¼Œåˆ™æ˜¯ä»è¯¥ proxy ç»§æ‰¿çš„å¯¹è±¡ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬ä¸éœ€è¦æ­¤å‚æ•°ï¼Œå› æ­¤ç¨åæˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚

    

  `set(target, property, value, receiver)`ï¼š

  - `target` â€”â€” æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è¢«ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ `new Proxy`ï¼Œ

  - `property` â€”â€” ç›®æ ‡å±æ€§åç§°ï¼Œ

  - `value` â€”â€” ç›®æ ‡å±æ€§çš„å€¼ï¼Œ

  - `receiver` â€”â€” ä¸ `get` æ•æ‰å™¨ç±»ä¼¼ï¼Œä»…ä¸ setter è®¿é—®å™¨å±æ€§ç›¸å…³ã€‚

    

  `has(target, property)`

  - `target` â€”â€” æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œè¢«ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ `new Proxy`ï¼Œ

  - `property` â€”â€” å±æ€§åç§°ã€‚

    

  `apply(target, thisArg, args)` æ•æ‰å™¨èƒ½ä½¿ä»£ç†ä»¥å‡½æ•°çš„æ–¹å¼è¢«è°ƒç”¨ï¼š

  - `target` æ˜¯ç›®æ ‡å¯¹è±¡ï¼ˆåœ¨ JavaScript ä¸­ï¼Œå‡½æ•°å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œ
  - `thisArg` æ˜¯ `this` çš„å€¼ã€‚
  - `args` æ˜¯å‚æ•°åˆ—è¡¨ã€‚

  ### 24.2 **Reflect**

  `Reflect` æ˜¯ä¸€ä¸ªå†…å»ºå¯¹è±¡ï¼Œå¯ç®€åŒ– `Proxy` çš„åˆ›å»ºã€‚

  å‰é¢æ‰€è®²è¿‡çš„å†…éƒ¨æ–¹æ³•ï¼Œä¾‹å¦‚ `[[Get]]` å’Œ `[[Set]]` ç­‰ï¼Œéƒ½åªæ˜¯è§„èŒƒæ€§çš„ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ã€‚

  `Reflect` å¯¹è±¡ä½¿è°ƒç”¨è¿™äº›å†…éƒ¨æ–¹æ³•æˆä¸ºäº†å¯èƒ½ã€‚å®ƒçš„æ–¹æ³•æ˜¯å†…éƒ¨æ–¹æ³•çš„æœ€å°åŒ…è£…ã€‚

  ä»¥ä¸‹æ˜¯æ‰§è¡Œç›¸åŒæ“ä½œå’Œ `Reflect` è°ƒç”¨çš„ç¤ºä¾‹ï¼š

  | æ“ä½œ                | `Reflect` è°ƒç”¨                      | å†…éƒ¨æ–¹æ³•        |
  | :------------------ | :---------------------------------- | :-------------- |
  | `obj[prop]`         | `Reflect.get(obj, prop)`            | `[[Get]]`       |
  | `obj[prop] = value` | `Reflect.set(obj, prop, value)`     | `[[Set]]`       |
  | `delete obj[prop]`  | `Reflect.deleteProperty(obj, prop)` | `[[Delete]]`    |
  | `new F(value)`      | `Reflect.construct(F, value)`       | `[[Construct]]` |
  | â€¦                   | â€¦                                   | â€¦               |
  
  ä¾‹å¦‚ï¼š
  
  ```javascript
  let user = {};
  
  Reflect.set(user, 'name', 'John');
  
  alert(user.name); // John
  ```
  
  å°¤å…¶æ˜¯ï¼Œ`Reflect` å…è®¸æˆ‘ä»¬å°†æ“ä½œç¬¦ï¼ˆ`new`ï¼Œ`delete`ï¼Œâ€¦â€¦ï¼‰ä½œä¸ºå‡½æ•°ï¼ˆ`Reflect.construct`ï¼Œ`Reflect.deleteProperty`ï¼Œâ€¦â€¦ï¼‰æ‰§è¡Œè°ƒç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹å¾ˆé‡è¦ã€‚
  
  **å¯¹äºæ¯ä¸ªå¯è¢« `Proxy` æ•è·çš„å†…éƒ¨æ–¹æ³•ï¼Œåœ¨ `Reflect` ä¸­éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ–¹æ³•ï¼Œå…¶åç§°å’Œå‚æ•°ä¸ `Proxy` æ•æ‰å™¨ç›¸åŒã€‚**

  æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Reflect` æ¥å°†æ“ä½œè½¬å‘ç»™åŸå§‹å¯¹è±¡ã€‚

  åœ¨ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæ•æ‰å™¨ `get` å’Œ `set` å‡é€æ˜åœ°ï¼ˆå¥½åƒå®ƒä»¬éƒ½ä¸å­˜åœ¨ä¸€æ ·ï¼‰å°†è¯»å–/å†™å…¥æ“ä½œè½¬å‘åˆ°å¯¹è±¡ï¼Œå¹¶æ˜¾ç¤ºä¸€æ¡æ¶ˆæ¯ï¼š

  

  ä¸€ä¸ª **å¯æ’¤é”€** çš„ä»£ç†æ˜¯å¯ä»¥è¢«ç¦ç”¨çš„ä»£ç†ã€‚

  å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªèµ„æºï¼Œå¹¶ä¸”æƒ³éšæ—¶å…³é—­å¯¹è¯¥èµ„æºçš„è®¿é—®ã€‚

  æˆ‘ä»¬å¯ä»¥åšçš„æ˜¯å°†å®ƒåŒ…è£…æˆå¯ä¸€ä¸ªæ’¤é”€çš„ä»£ç†ï¼Œæ²¡æœ‰ä»»ä½•æ•æ‰å™¨ã€‚è¿™æ ·çš„ä»£ç†ä¼šå°†æ“ä½œè½¬å‘ç»™å¯¹è±¡ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥éšæ—¶å°†å…¶ç¦ç”¨ã€‚

  è¯­æ³•ä¸ºï¼š

  ```javascript
  let {proxy, revoke} = Proxy.revocable(target, handler)
  ```

  å¯¹ `revoke()` çš„è°ƒç”¨ä¼šä»ä»£ç†ä¸­åˆ é™¤å¯¹ç›®æ ‡å¯¹è±¡çš„æ‰€æœ‰å†…éƒ¨å¼•ç”¨ï¼Œå› æ­¤å®ƒä»¬ä¹‹é—´å†æ— è¿æ¥ã€‚

### 24.3 Evalï¼šæ‰§è¡Œä»£ç å­—ç¬¦ä¸²

è¯­æ³•å¦‚ä¸‹ï¼š

```javascript
let result = eval(code);
```

è°ƒç”¨ `eval(code)` ä¼šè¿è¡Œä»£ç å­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æœ€åä¸€æ¡è¯­å¥çš„ç»“æœã€‚

- åœ¨ç°ä»£ JavaScript ç¼–ç¨‹ä¸­ï¼Œå¾ˆå°‘ä½¿ç”¨å®ƒï¼Œé€šå¸¸ä¹Ÿä¸éœ€è¦ä½¿ç”¨å®ƒã€‚
- å¯ä»¥è®¿é—®å¤–éƒ¨å±€éƒ¨å˜é‡ã€‚è¿™è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚
- è¦åœ¨å…¨å±€ä½œç”¨åŸŸä¸­ `eval` ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ `window.eval(code)` è¿›è¡Œæ›¿ä»£ã€‚
- æ­¤å¤–ï¼Œå¦‚æœä½ çš„ä»£ç éœ€è¦ä»å¤–éƒ¨ä½œç”¨åŸŸè·å–æ•°æ®ï¼Œè¯·ä½¿ç”¨ `new Function`ï¼Œå¹¶å°†æ•°æ®ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚

### 24.4 Reference type è§£è¯»

ä»”ç»†çœ‹çš„è¯ï¼Œæˆ‘ä»¬å¯èƒ½æ³¨æ„åˆ° `obj.method()` è¯­å¥ä¸­çš„ä¸¤ä¸ªæ“ä½œï¼š

1. é¦–å…ˆï¼Œç‚¹ `'.'` å–äº†å±æ€§ `obj.method` çš„å€¼ã€‚
2. æ¥ç€ `()` æ‰§è¡Œäº†å®ƒã€‚

é‚£ä¹ˆï¼Œ`this` çš„ä¿¡æ¯æ˜¯æ€ä¹ˆä»ç¬¬ä¸€éƒ¨åˆ†ä¼ é€’åˆ°ç¬¬äºŒéƒ¨åˆ†çš„å‘¢ï¼Ÿ

å¦‚æœæˆ‘ä»¬å°†è¿™äº›æ“ä½œæ”¾åœ¨ä¸åŒçš„è¡Œï¼Œ`this` å¿…å®šæ˜¯ä¼šä¸¢å¤±çš„ï¼Œä¾‹å¦‚

~~~js
const obj = {
	name:"renjia",
	to(){
		console.log(this.name)
	}
}
obj.to() //name=renjia

const callfun=obj.to   // è¿™é‡Œå°±ç›¸å½“äºåœ¨å®šä¹‰callfunå‡½æ•°ï¼Œåªæ˜¯æŠŠobj.toçš„å‡½æ•°ä½“èµ‹ç»™callfunå˜é‡äº†ã€‚
call() //nmae=undefined
~~~

Reference Type æ˜¯ ECMA ä¸­çš„ä¸€ä¸ªâ€œè§„èŒƒç±»å‹â€ã€‚æˆ‘ä»¬ä¸èƒ½ç›´æ¥ä½¿ç”¨å®ƒï¼Œä½†å®ƒè¢«ç”¨åœ¨ JavaScript è¯­è¨€å†…éƒ¨ã€‚

Reference Type çš„å€¼æ˜¯ä¸€ä¸ªä¸‰ä¸ªå€¼çš„ç»„åˆ `(base, name, strict)`ï¼Œå…¶ä¸­ï¼š

- `base` æ˜¯å¯¹è±¡ã€‚
- `name` æ˜¯å±æ€§åã€‚
- `strict` åœ¨ `use strict` æ¨¡å¼ä¸‹ä¸º trueã€‚



## 26. å…¶ä»–æ–‡ç« 

### 26.2 ç½‘ç»œè¯·æ±‚

#### 26.2.1 Fetch

åŸºæœ¬è¯­æ³•ï¼š

```javascript
let promise = fetch(url, [options])
```

- **`url`** â€”â€” è¦è®¿é—®çš„ URLã€‚
- **`options`** â€”â€” å¯é€‰å‚æ•°ï¼šmethodï¼Œheader ç­‰ã€‚

å…¸å‹çš„ fetch è¯·æ±‚ç”±ä¸¤ä¸ª `await` è°ƒç”¨ç»„æˆï¼š

```javascript
let response = await fetch(url, options); // è§£æ response header
let result = await response.json(); // å°† body è¯»å–ä¸º json
```

æˆ–è€…ä»¥ promise å½¢å¼ï¼š

```javascript
fetch(url, options)
  .then(response => response.json())
  .then(result => /* process result */)
```

å“åº”çš„å±æ€§ï¼š

- `response.status` â€”â€” response çš„ HTTP çŠ¶æ€ç ï¼Œ
- `response.ok` â€”â€” HTTP çŠ¶æ€ç ä¸º 200-299ï¼Œåˆ™ä¸º `true`ã€‚
- `response.headers` â€”â€” ç±»ä¼¼äº Map çš„å¸¦æœ‰ HTTP header çš„å¯¹è±¡ã€‚

è·å– response body çš„æ–¹æ³•ï¼š

- **`response.text()`** â€”â€” è¯»å– responseï¼Œå¹¶ä»¥æ–‡æœ¬å½¢å¼è¿”å› responseï¼Œ
- **`response.json()`** â€”â€” å°† response è§£æä¸º JSON å¯¹è±¡å½¢å¼ï¼Œ
- **`response.formData()`** â€”â€” ä»¥ `FormData` å¯¹è±¡ï¼ˆ`multipart/form-data` ç¼–ç ï¼Œå‚è§ä¸‹ä¸€ç« ï¼‰çš„å½¢å¼è¿”å› responseï¼Œ
- **`response.blob()`** â€”â€” ä»¥ [Blob](https://zh.javascript.info/blob)ï¼ˆå…·æœ‰ç±»å‹çš„äºŒè¿›åˆ¶æ•°æ®ï¼‰å½¢å¼è¿”å› responseï¼Œ
- **`response.arrayBuffer()`** â€”â€” ä»¥ [ArrayBuffer](https://zh.javascript.info/arraybuffer-binary-arrays)ï¼ˆä½çº§åˆ«çš„äºŒè¿›åˆ¶æ•°æ®ï¼‰å½¢å¼è¿”å› responseã€‚

åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬äº†è§£åˆ°çš„ fetch é€‰é¡¹ï¼š

- `method` â€”â€” HTTP æ–¹æ³•ï¼Œ
- `headers` â€”â€” å…·æœ‰ request header çš„å¯¹è±¡ï¼ˆä¸æ˜¯æ‰€æœ‰ header éƒ½æ˜¯è¢«å…è®¸çš„ï¼‰
- `body` â€”â€” è¦ä»¥ `string`ï¼Œ`FormData`ï¼Œ`BufferSource`ï¼Œ`Blob` æˆ– `UrlSearchParams` å¯¹è±¡çš„å½¢å¼å‘é€çš„æ•°æ®ï¼ˆrequest bodyï¼‰ã€‚

ä½œä¸ºä¸€ä¸ªè¯»å–ä¸ºäºŒè¿›åˆ¶æ ¼å¼çš„æ¼”ç¤ºç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬ fetch å¹¶æ˜¾ç¤ºä¸€å¼  [â€œfetchâ€ è§„èŒƒ](https://fetch.spec.whatwg.org/) ä¸­çš„å›¾ç‰‡ï¼ˆ`Blob` æ“ä½œçš„æœ‰å…³å†…å®¹è¯·è§ [Blob](https://zh.javascript.info/blob)ï¼‰ï¼š

```javascript
let response = await fetch('/article/fetch/logo-fetch.svg');

let blob = await response.blob(); // ä¸‹è½½ä¸º Blob å¯¹è±¡

// ä¸ºå…¶åˆ›å»ºä¸€ä¸ª <img>
let img = document.createElement('img');
img.style = 'position:fixed;top:10px;left:10px;width:100px';
document.body.append(img);

// æ˜¾ç¤ºå®ƒ
img.src = URL.createObjectURL(blob);

setTimeout(() => { // 3 ç§’åå°†å…¶éšè—
  img.remove();
  URL.revokeObjectURL(img.src);
}, 3000);
```

POST è¯·æ±‚ï¼š

è¦åˆ›å»ºä¸€ä¸ª `POST` è¯·æ±‚ï¼Œæˆ–è€…å…¶ä»–æ–¹æ³•çš„è¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ `fetch` é€‰é¡¹ï¼š

- **`method`** â€”â€” HTTP æ–¹æ³•ï¼Œä¾‹å¦‚ `POST`ï¼Œ

- `body`

  â€”â€” request bodyï¼Œå…¶ä¸­ä¹‹ä¸€ï¼š

  - å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ JSON ç¼–ç çš„ï¼‰ï¼Œ
  - `FormData` å¯¹è±¡ï¼Œä»¥ `multipart/form-data` å½¢å¼å‘é€æ•°æ®ï¼Œ
  - `Blob`/`BufferSource` å‘é€äºŒè¿›åˆ¶æ•°æ®ï¼Œ
  - [URLSearchParams](https://zh.javascript.info/url)ï¼Œä»¥ `x-www-form-urlencoded` ç¼–ç å½¢å¼å‘é€æ•°æ®ï¼Œå¾ˆå°‘ä½¿ç”¨ã€‚

JSON å½¢å¼æ˜¯æœ€å¸¸ç”¨çš„ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ä»¥ JSON å½¢å¼å‘é€ `user` å¯¹è±¡ï¼š

```javascript
let user = {
  name: 'John',
  surname: 'Smith'
};

let response = await fetch('/article/fetch/post/user', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json;charset=utf-8'
  },
  body: JSON.stringify(user)
});

let result = await response.json();
alert(result.message);
```

#### 26.2.2 FormData

è¿™ä¸€ç« æ˜¯å…³äºå‘é€ HTML è¡¨å•çš„ï¼šå¸¦æœ‰æˆ–ä¸å¸¦æ–‡ä»¶ï¼Œå¸¦æœ‰å…¶ä»–å­—æ®µç­‰ã€‚

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå®ƒå‡ ä¹å°±æ˜¯ä¸€è¡Œä»£ç ï¼š

```javascript
<form id="formElem">
  <input type="text" name="name" value="John">
  <input type="text" name="surname" value="Smith">
  <input type="submit">
</form>

<script>
  formElem.onsubmit = async (e) => {
    e.preventDefault();

    let response = await fetch('/article/formdata/post/user', {
      method: 'POST',
      body: new FormData(formElem)
    });

    let result = await response.json();

    alert(result.message);
  };
</script>
```



**FormData æ–¹æ³•**:

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ä¿®æ”¹ `FormData` ä¸­çš„å­—æ®µï¼š

- `formData.append(name, value)` â€”â€” æ·»åŠ å…·æœ‰ç»™å®š `name` å’Œ `value` çš„è¡¨å•å­—æ®µï¼Œ
- `formData.append(name, blob, fileName)` â€”â€” æ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œå°±åƒå®ƒæ˜¯ `<input type="file">`ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° `fileName` è®¾ç½®æ–‡ä»¶åï¼ˆè€Œä¸æ˜¯è¡¨å•å­—æ®µåï¼‰ï¼Œå› ä¸ºå®ƒæ˜¯ç”¨æˆ·æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶çš„åç§°ï¼Œ
- `formData.delete(name)` â€”â€” ç§»é™¤å¸¦æœ‰ç»™å®š `name` çš„å­—æ®µï¼Œ
- `formData.get(name)` â€”â€” è·å–å¸¦æœ‰ç»™å®š `name` çš„å­—æ®µå€¼ï¼Œ
- `formData.has(name)` â€”â€” å¦‚æœå­˜åœ¨å¸¦æœ‰ç»™å®š `name` çš„å­—æ®µï¼Œåˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚

ä»æŠ€æœ¯ä¸Šæ¥è®²ï¼Œä¸€ä¸ªè¡¨å•å¯ä»¥åŒ…å«å¤šä¸ªå…·æœ‰ç›¸åŒ `name` çš„å­—æ®µï¼Œå› æ­¤ï¼Œå¤šæ¬¡è°ƒç”¨ `append` å°†ä¼šæ·»åŠ å¤šä¸ªå…·æœ‰ç›¸åŒåç§°çš„å­—æ®µã€‚

è¿˜æœ‰ä¸€ä¸ª `set` æ–¹æ³•ï¼Œè¯­æ³•ä¸ `append` ç›¸åŒã€‚ä¸åŒä¹‹å¤„åœ¨äº `.set` ç§»é™¤æ‰€æœ‰å…·æœ‰ç»™å®š `name` çš„å­—æ®µï¼Œç„¶åé™„åŠ ä¸€ä¸ªæ–°å­—æ®µã€‚å› æ­¤ï¼Œå®ƒç¡®ä¿äº†åªæœ‰ä¸€ä¸ªå…·æœ‰è¿™ç§ `name` çš„å­—æ®µï¼Œå…¶ä»–çš„å’Œ `append` ä¸€æ ·ï¼š

- `formData.set(name, value)`ï¼Œ
- `formData.set(name, blob, fileName)`ã€‚



#### 26.2.3 XMLHttpRequest

[HttpServletResponse ServletResponse è¿”å›å“åº” è®¾ç½®å“åº”å¤´è®¾ç½®å“åº”æ­£æ–‡ä½“ é‡å®šå‘ å¸¸ç”¨æ–¹æ³• å¦‚ä½•é‡å®šå‘ å“åº”ç¼–ç  å“åº”ä¹±ç  - åˆ˜è¾¾äºº186 - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/xiang--liu/p/11505721.html)

[æ·±å…¥ç†è§£XMLHttpRequest - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6844904052875067400)

[(19æ¡æ¶ˆæ¯) httpè¯·æ±‚xmlå“åº”å¦‚ä½•å¤„ç†ä¹±ç  - CSDN](https://www.csdn.net/tags/MtTaMg0sNzcyNDA1LWJsb2cO0O0O.html)

åœ¨ç°ä»£ Web å¼€å‘ä¸­ï¼Œå‡ºäºä»¥ä¸‹ä¸‰ç§åŸå› ï¼Œæˆ‘ä»¬è¿˜åœ¨ä½¿ç”¨ `XMLHttpRequest`ï¼š

1. å†å²åŸå› ï¼šæˆ‘ä»¬éœ€è¦æ”¯æŒç°æœ‰çš„ä½¿ç”¨äº† `XMLHttpRequest` çš„è„šæœ¬ã€‚
2. æˆ‘ä»¬éœ€è¦å…¼å®¹æ—§æµè§ˆå™¨ï¼Œå¹¶ä¸”ä¸æƒ³ç”¨ polyfillï¼ˆä¾‹å¦‚ä¸ºäº†ä½¿è„šæœ¬æ›´å°ï¼‰ã€‚
3. æˆ‘ä»¬éœ€è¦åšä¸€äº› `fetch` ç›®å‰æ— æ³•åšåˆ°çš„äº‹æƒ…ï¼Œä¾‹å¦‚è·Ÿè¸ªä¸Šä¼ è¿›åº¦ã€‚

XMLHttpRequest æœ‰ä¸¤ç§æ‰§è¡Œæ¨¡å¼ï¼šåŒæ­¥ï¼ˆsynchronousï¼‰å’Œå¼‚æ­¥ï¼ˆasynchronousï¼‰ã€‚

æˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹æœ€å¸¸ç”¨çš„å¼‚æ­¥æ¨¡å¼ï¼š

è¦å‘é€è¯·æ±‚ï¼Œéœ€è¦ 3 ä¸ªæ­¥éª¤ï¼š

1. åˆ›å»º `XMLHttpRequest`ï¼š

   ```javascript
   let xhr = new XMLHttpRequest();
   ```

   æ­¤æ„é€ å™¨æ²¡æœ‰å‚æ•°ã€‚

2. åˆå§‹åŒ–å®ƒï¼Œé€šå¸¸å°±åœ¨ `new XMLHttpRequest` ä¹‹åï¼š

   ```javascript
   xhr.open(method, URL, [async, user, password])
   ```

   æ­¤æ–¹æ³•æŒ‡å®šè¯·æ±‚çš„ä¸»è¦å‚æ•°ï¼š

   - `method` â€”â€” HTTP æ–¹æ³•ã€‚é€šå¸¸æ˜¯ `"GET"` æˆ– `"POST"`ã€‚
   - `URL` â€”â€” è¦è¯·æ±‚çš„ URLï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ [URL](https://zh.javascript.info/url) å¯¹è±¡ã€‚
   - `async` â€”â€” å¦‚æœæ˜¾å¼åœ°è®¾ç½®ä¸º `false`ï¼Œé‚£ä¹ˆè¯·æ±‚å°†ä¼šä»¥åŒæ­¥çš„æ–¹å¼å¤„ç†ï¼Œæˆ‘ä»¬ç¨åä¼šè®²åˆ°å®ƒã€‚
   - `user`ï¼Œ`password` â€”â€” HTTP åŸºæœ¬èº«ä»½éªŒè¯ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰çš„ç™»å½•åå’Œå¯†ç ã€‚

   è¯·æ³¨æ„ï¼Œ`open` è°ƒç”¨ä¸å…¶åç§°ç›¸åï¼Œä¸ä¼šå»ºç«‹è¿æ¥ã€‚å®ƒä»…é…ç½®è¯·æ±‚ï¼Œè€Œç½‘ç»œæ´»åŠ¨ä»…ä»¥ `send` è°ƒç”¨å¼€å¯ã€‚

3. å‘é€è¯·æ±‚ã€‚

   ```javascript
   xhr.send([body])
   ```

   è¿™ä¸ªæ–¹æ³•ä¼šå»ºç«‹è¿æ¥ï¼Œå¹¶å°†è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ã€‚å¯é€‰å‚æ•° `body` åŒ…å«äº† request bodyã€‚

4. ç›‘å¬ `xhr` äº‹ä»¶ä»¥è·å–å“åº”ã€‚

   è¿™ä¸‰ä¸ªäº‹ä»¶æ˜¯æœ€å¸¸ç”¨çš„ï¼š

   - `load` â€”â€” å½“è¯·æ±‚å®Œæˆï¼ˆå³ä½¿ HTTP çŠ¶æ€ä¸º 400 æˆ– 500 ç­‰ï¼‰ï¼Œå¹¶ä¸”å“åº”å·²å®Œå…¨ä¸‹è½½ã€‚

   - `error` â€”â€” å½“æ— æ³•å‘å‡ºè¯·æ±‚ï¼Œä¾‹å¦‚ç½‘ç»œä¸­æ–­æˆ–è€…æ— æ•ˆçš„ URLã€‚

   - `progress` â€”â€” åœ¨ä¸‹è½½å“åº”æœŸé—´å®šæœŸè§¦å‘ï¼ŒæŠ¥å‘Šå·²ç»ä¸‹è½½äº†å¤šå°‘ã€‚

     ~~~javascript
     xhr.onprogress = function(event) {
       if (event.lengthComputable) {
         alert(`Received ${event.loaded} of ${event.total} bytes`);
       } else {
         alert(`Received ${event.loaded} bytes`); // æ²¡æœ‰ Content-Length
       }
     
     };
     ~~~

     

ä¸€æ—¦æœåŠ¡å™¨æœ‰äº†å“åº”ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»¥ä¸‹ `xhr` å±æ€§ä¸­æ¥æ”¶ç»“æœï¼š

- `status`

  HTTP çŠ¶æ€ç ï¼ˆä¸€ä¸ªæ•°å­—ï¼‰ï¼š`200`ï¼Œ`404`ï¼Œ`403` ç­‰ï¼Œå¦‚æœå‡ºç°é HTTP é”™è¯¯ï¼Œåˆ™ä¸º `0`ã€‚

- `statusText`

  HTTP çŠ¶æ€æ¶ˆæ¯ï¼ˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼šçŠ¶æ€ç ä¸º `200` å¯¹åº”äº `OK`ï¼Œ`404` å¯¹åº”äº `Not Found`ï¼Œ`403` å¯¹åº”äº `Forbidden`ã€‚

##### 26.2.3.1 **å“åº”æ•°æ®**

æ•°æ®åœ¨`xhr.response`é‡Œé¢

##### 26.2.3.2 **å“åº”ç±»å‹ï¼š**

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `xhr.responseType` å±æ€§æ¥è®¾ç½®å“åº”æ ¼å¼ï¼š

- `""`ï¼ˆé»˜è®¤ï¼‰â€”â€” å“åº”æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œ
- `"text"` â€”â€” å“åº”æ ¼å¼ä¸ºå­—ç¬¦ä¸²ï¼Œ
- `"arraybuffer"` â€”â€” å“åº”æ ¼å¼ä¸º `ArrayBuffer`ï¼ˆå¯¹äºäºŒè¿›åˆ¶æ•°æ®ï¼Œè¯·å‚è§ [ArrayBufferï¼ŒäºŒè¿›åˆ¶æ•°ç»„](https://zh.javascript.info/arraybuffer-binary-arrays)ï¼‰ï¼Œ
- `"blob"` â€”â€” å“åº”æ ¼å¼ä¸º `Blob`ï¼ˆå¯¹äºäºŒè¿›åˆ¶æ•°æ®ï¼Œè¯·å‚è§ [Blob](https://zh.javascript.info/blob)ï¼‰ï¼Œ
- `"document"` â€”â€” å“åº”æ ¼å¼ä¸º XML documentï¼ˆå¯ä»¥ä½¿ç”¨ XPath å’Œå…¶ä»– XML æ–¹æ³•ï¼‰æˆ– HTML documentï¼ˆåŸºäºæ¥æ”¶æ•°æ®çš„ MIME ç±»å‹ï¼‰
- `"json"` â€”â€” å“åº”æ ¼å¼ä¸º JSONï¼ˆè‡ªåŠ¨è§£æï¼‰ã€‚

**HTTP-header**

HTTP-header æœ‰ä¸‰ç§æ–¹æ³•ï¼š

- `setRequestHeader(name, value)`

  ä½¿ç”¨ç»™å®šçš„ `name` å’Œ `value` è®¾ç½® request headerã€‚ä¾‹å¦‚ï¼š

  ~~~javascript
  xhr.setRequestHeader('Content-Type', 'application/json');
  ~~~

- `getResponseHeader(name)`

  è·å–å…·æœ‰ç»™å®š `name` çš„ headerï¼ˆ`Set-Cookie` å’Œ `Set-Cookie2` é™¤å¤–ï¼‰ã€‚

- `getAllResponseHeaders()`

  è¿”å›é™¤ `Set-Cookie` å’Œ `Set-Cookie2` å¤–çš„æ‰€æœ‰ response headerã€‚

  header ä»¥å•è¡Œå½¢å¼è¿”å›

##### 26.2.3.3 **ä¸Šä¼ è¿›åº¦**

`progress` äº‹ä»¶ä»…åœ¨ä¸‹è½½é˜¶æ®µè§¦å‘ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼šå¦‚æœæˆ‘ä»¬ `POST` ä¸€äº›å†…å®¹ï¼Œ`XMLHttpRequest` é¦–å…ˆä¸Šä¼ æˆ‘ä»¬çš„æ•°æ®ï¼ˆrequest bodyï¼‰ï¼Œç„¶åä¸‹è½½å“åº”ã€‚

å¦‚æœæˆ‘ä»¬è¦ä¸Šä¼ çš„ä¸œè¥¿å¾ˆå¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‚¯å®šä¼šå¯¹è·Ÿè¸ªä¸Šä¼ è¿›åº¦æ„Ÿå…´è¶£ã€‚ä½†æ˜¯ `xhr.onprogress` åœ¨è¿™é‡Œå¹¶ä¸èµ·ä½œç”¨ã€‚

è¿™é‡Œæœ‰å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæ²¡æœ‰æ–¹æ³•ï¼Œå®ƒä¸“é—¨ç”¨äºè·Ÿè¸ªä¸Šä¼ äº‹ä»¶ï¼š`xhr.upload`ã€‚

å®ƒä¼šç”Ÿæˆäº‹ä»¶ï¼Œç±»ä¼¼äº `xhr`ï¼Œä½†æ˜¯ `xhr.upload` ä»…åœ¨ä¸Šä¼ æ—¶è§¦å‘å®ƒä»¬ï¼š

- `loadstart` â€”â€” ä¸Šä¼ å¼€å§‹ã€‚

- `progress` â€”â€” ä¸Šä¼ æœŸé—´å®šæœŸè§¦å‘ã€‚

- `abort` â€”â€” ä¸Šä¼ ä¸­æ­¢ã€‚

- `error` â€”â€” é HTTP é”™è¯¯ã€‚

- `load` â€”â€” ä¸Šä¼ æˆåŠŸå®Œæˆã€‚

- `timeout` â€”â€” ä¸Šä¼ è¶…æ—¶ï¼ˆå¦‚æœè®¾ç½®äº† `timeout` å±æ€§ï¼‰ã€‚

- `loadend` â€”â€” ä¸Šä¼ å®Œæˆï¼Œæ— è®ºæˆåŠŸè¿˜æ˜¯ errorã€‚

  ~~~javascript
  xhr.upload.onprogress = function(event) {
    alert(`Uploaded ${event.loaded} of ${event.total} bytes`);
  };
  
  xhr.upload.onload = function() {
    alert(`Upload finished successfully.`);
  };
  
  xhr.upload.onerror = function() {
    alert(`Error during the upload: ${xhr.status}`);
  };
  ~~~


##### 26.2.3.4 **è·¨åŸŸè¯·æ±‚**

`XMLHttpRequest` å¯ä»¥ä½¿ç”¨å’Œ [fetch](https://zh.javascript.info/fetch-crossorigin) ç›¸åŒçš„ CORS ç­–ç•¥è¿›è¡Œè·¨æºè¯·æ±‚ã€‚

å°±åƒ `fetch` ä¸€æ ·ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ä¼šå°† cookie å’Œ HTTP æˆæƒå‘é€åˆ°å…¶ä»–åŸŸã€‚è¦å¯ç”¨å®ƒä»¬ï¼Œå¯ä»¥å°† `xhr.withCredentials` è®¾ç½®ä¸º `true`ï¼š

```javascript
let xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.open('POST', 'http://anywhere.com/request');
...
```

26.2.4 **URL æœç´¢å‚æ•°ï¼ˆURL search parametersï¼‰**

ä¸ºäº†å‘ URL æ·»åŠ åƒ `?name=value` è¿™æ ·çš„å‚æ•°ï¼Œå¹¶ç¡®ä¿æ­£ç¡®çš„ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ [URL](https://zh.javascript.info/url) å¯¹è±¡ï¼š

```javascript
let url = new URL('https://google.com/search');
url.searchParams.set('q', 'test me!');

// å‚æ•° 'q' è¢«ç¼–ç 
xhr.open('GET', url); // https://google.com/search?q=test+me%21
```



### 26.3 åœ¨æµè§ˆå™¨ä¸­å­˜å‚¨æ•°æ®

#### 26.3.1 Cookieï¼Œdocument.cookie

Cookie é€šå¸¸æ˜¯ç”± Web æœåŠ¡å™¨ä½¿ç”¨å“åº” `Set-Cookie` HTTP-header è®¾ç½®çš„ã€‚ç„¶åæµè§ˆå™¨ä½¿ç”¨ `Cookie` HTTP-header å°†å®ƒä»¬è‡ªåŠ¨æ·»åŠ åˆ°ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå¯¹ç›¸åŒåŸŸçš„è¯·æ±‚ä¸­ã€‚

é€‰é¡¹è¢«åˆ—åœ¨ `key=value` ä¹‹åï¼Œä»¥ `;` åˆ†éš”ï¼Œåƒè¿™æ ·ï¼š

```javascript
document.cookie = "user=John; path=/; expires=Tue, 19 Jan 2038 03:14:07 GMT"
```

`document.cookie` æä¾›äº†å¯¹ cookie çš„è®¿é—®

- å†™å…¥æ“ä½œåªä¼šä¿®æ”¹å…¶ä¸­æåˆ°çš„ cookieã€‚
- name/value å¿…é¡»è¢«ç¼–ç ã€‚
- ä¸€ä¸ª cookie æœ€å¤§ä¸èƒ½è¶…è¿‡ 4KBã€‚æ¯ä¸ªåŸŸä¸‹æœ€å¤šå…è®¸æœ‰ 20+ ä¸ªå·¦å³çš„ cookieï¼ˆå…·ä½“å–å†³äºæµè§ˆå™¨ï¼‰ã€‚

Cookie é€‰é¡¹ï¼š

- `path=/`ï¼Œé»˜è®¤ä¸ºå½“å‰è·¯å¾„ï¼Œä½¿ cookie ä»…åœ¨è¯¥è·¯å¾„ä¸‹å¯è§ã€‚

  url è·¯å¾„å‰ç¼€å¿…é¡»æ˜¯ç»å¯¹è·¯å¾„ã€‚å®ƒä½¿å¾—è¯¥è·¯å¾„ä¸‹çš„é¡µé¢å¯ä»¥è®¿é—®è¯¥ cookieã€‚é»˜è®¤ä¸ºå½“å‰è·¯å¾„ã€‚

  å¦‚æœä¸€ä¸ª cookie å¸¦æœ‰ `path=/admin` è®¾ç½®ï¼Œé‚£ä¹ˆè¯¥ cookie åœ¨ `/admin` å’Œ `/admin/something` ä¸‹éƒ½æ˜¯å¯è§çš„ï¼Œä½†æ˜¯åœ¨ `/home` æˆ– `/adminpage` ä¸‹ä¸å¯è§ã€‚

  é€šå¸¸ï¼Œæˆ‘ä»¬åº”è¯¥å°† `path` è®¾ç½®ä¸ºæ ¹ç›®å½•ï¼š`path=/`ï¼Œä»¥ä½¿ cookie å¯¹æ­¤ç½‘ç«™çš„æ‰€æœ‰é¡µé¢å¯è§ã€‚

- `domain=site.com`ï¼Œé»˜è®¤ cookie ä»…åœ¨å½“å‰åŸŸä¸‹å¯è§ã€‚å¦‚æœæ˜¾å¼åœ°è®¾ç½®äº†åŸŸï¼Œå¯ä»¥ä½¿ cookie åœ¨å­åŸŸä¸‹ä¹Ÿå¯è§ã€‚

- `expires` æˆ– `max-age` è®¾å®šäº† cookie è¿‡æœŸæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™å½“æµè§ˆå™¨å…³é—­æ—¶ cookie å°±ä¼šå¤±æ•ˆã€‚

  å®ƒæ˜¯ `expires` çš„æ›¿ä»£é€‰é¡¹ï¼ŒæŒ‡æ˜äº† cookie çš„è¿‡æœŸæ—¶é—´è·ç¦»å½“å‰æ—¶é—´çš„ç§’æ•°ã€‚

  å¦‚æœå°†å…¶è®¾ç½®ä¸º 0 æˆ–è´Ÿæ•°ï¼Œåˆ™ cookie ä¼šè¢«åˆ é™¤ï¼š

  ```javascript
  // cookie ä¼šåœ¨ä¸€å°æ—¶åå¤±æ•ˆ
  document.cookie = "user=John; max-age=3600";
  
  // åˆ é™¤ cookieï¼ˆè®©å®ƒç«‹å³è¿‡æœŸï¼‰
  document.cookie = "user=John; max-age=0";
  ```

- `secure` ä½¿ cookie ä»…åœ¨ HTTPS ä¸‹æœ‰æ•ˆã€‚

- `samesite`ï¼Œå¦‚æœè¯·æ±‚æ¥è‡ªå¤–éƒ¨ç½‘ç«™ï¼Œç¦æ­¢æµè§ˆå™¨å‘é€ cookieã€‚è¿™æœ‰åŠ©äºé˜²æ­¢ XSRF æ”»å‡»ã€‚`samesite=strict` çš„ cookie æ°¸è¿œä¸ä¼šè¢«å‘é€ã€‚

#### 26.3.2 LocalStorageï¼ŒsessionStorage

Web å­˜å‚¨å¯¹è±¡ `localStorage` å’Œ `sessionStorage` å…è®¸æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šä¿å­˜é”®/å€¼å¯¹ã€‚

::: tip

æˆ‘ä»¬å·²ç»æœ‰äº† cookieã€‚ä¸ºä»€ä¹ˆè¿˜è¦å…¶ä»–å­˜å‚¨å¯¹è±¡å‘¢ï¼Ÿ

- ä¸ cookie ä¸åŒï¼ŒWeb å­˜å‚¨å¯¹è±¡ä¸ä¼šéšæ¯ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¿å­˜æ›´å¤šæ•°æ®ã€‚å¤§å¤šæ•°æµè§ˆå™¨éƒ½å…è®¸ä¿å­˜è‡³å°‘ 2MB çš„æ•°æ®ï¼ˆæˆ–æ›´å¤šï¼‰ï¼Œå¹¶ä¸”å…·æœ‰ç”¨äºé…ç½®æ•°æ®çš„è®¾ç½®ã€‚
- è¿˜æœ‰ä¸€ç‚¹å’Œ cookie ä¸åŒï¼ŒæœåŠ¡å™¨æ— æ³•é€šè¿‡ HTTP header æ“çºµå­˜å‚¨å¯¹è±¡ã€‚ä¸€åˆ‡éƒ½æ˜¯åœ¨ JavaScript ä¸­å®Œæˆçš„ã€‚
- å­˜å‚¨ç»‘å®šåˆ°æºï¼ˆåŸŸ/åè®®/ç«¯å£ä¸‰è€…ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒåè®®æˆ–å­åŸŸå¯¹åº”ä¸åŒçš„å­˜å‚¨å¯¹è±¡ï¼Œå®ƒä»¬ä¹‹é—´æ— æ³•è®¿é—®å½¼æ­¤æ•°æ®ã€‚

:::

ä¸¤ä¸ªå­˜å‚¨å¯¹è±¡éƒ½æä¾›ç›¸åŒçš„æ–¹æ³•å’Œå±æ€§ï¼š

- `setItem(key, value)` â€”â€” å­˜å‚¨é”®/å€¼å¯¹ã€‚
- `getItem(key)` â€”â€” æŒ‰ç…§é”®è·å–å€¼ã€‚
- `removeItem(key)` â€”â€” åˆ é™¤é”®åŠå…¶å¯¹åº”çš„å€¼ã€‚
- `clear()` â€”â€” åˆ é™¤æ‰€æœ‰æ•°æ®ã€‚
- `key(index)` â€”â€” è·å–è¯¥ç´¢å¼•ä¸‹çš„é”®åã€‚
- `length` â€”â€” å­˜å‚¨çš„å†…å®¹çš„é•¿åº¦ã€‚

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå®ƒå°±åƒä¸€ä¸ª `Map` é›†åˆï¼ˆ`setItem/getItem/removeItem`ï¼‰ï¼Œä½†ä¹Ÿå…è®¸é€šè¿‡ `key(index)` æ¥æŒ‰ç´¢å¼•è®¿é—®ã€‚

`localStorage` æœ€ä¸»è¦çš„ç‰¹ç‚¹æ˜¯ï¼š

- åœ¨åŒæºçš„æ‰€æœ‰æ ‡ç­¾é¡µå’Œçª—å£ä¹‹é—´å…±äº«æ•°æ®ã€‚
- æ•°æ®ä¸ä¼šè¿‡æœŸã€‚å®ƒåœ¨æµè§ˆå™¨é‡å¯ç”šè‡³ç³»ç»Ÿé‡å¯åä»ç„¶å­˜åœ¨ã€‚

æˆ‘ä»¬åªéœ€è¦åœ¨åŒä¸€ä¸ªæºï¼ˆåŸŸ/ç«¯å£/åè®®ï¼‰ï¼ŒURL è·¯å¾„å¯ä»¥ä¸åŒã€‚

åœ¨æ‰€æœ‰åŒæºçš„çª—å£ä¹‹é—´ï¼Œ`localStorage` æ•°æ®å¯ä»¥å…±äº«ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªçª—å£ä¸­è®¾ç½®äº†æ•°æ®ï¼Œåˆ™åœ¨å¦ä¸€ä¸ªçª—å£ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ°æ•°æ®å˜åŒ–ã€‚

`sessionStorage` å¯¹è±¡çš„ä½¿ç”¨é¢‘ç‡æ¯” `localStorage` å¯¹è±¡ä½å¾—å¤šã€‚

å±æ€§å’Œæ–¹æ³•æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯å®ƒæœ‰æ›´å¤šçš„é™åˆ¶ï¼š

- `sessionStorage`çš„æ•°æ®åªå­˜åœ¨äºå½“å‰æµè§ˆå™¨æ ‡ç­¾é¡µã€‚
  - å…·æœ‰ç›¸åŒé¡µé¢çš„å¦ä¸€ä¸ªæ ‡ç­¾é¡µä¸­å°†ä¼šæœ‰ä¸åŒçš„å­˜å‚¨ã€‚
  - ä½†æ˜¯ï¼Œå®ƒåœ¨åŒä¸€æ ‡ç­¾é¡µä¸‹çš„ iframe ä¹‹é—´æ˜¯å…±äº«çš„ï¼ˆå‡å¦‚å®ƒä»¬æ¥è‡ªç›¸åŒçš„æºï¼‰ã€‚
- æ•°æ®åœ¨é¡µé¢åˆ·æ–°åä»ç„¶ä¿ç•™ï¼Œä½†åœ¨å…³é—­/é‡æ–°æ‰“å¼€æµè§ˆå™¨æ ‡ç­¾é¡µåä¸ä¼šè¢«ä¿ç•™ã€‚

å½“ `localStorage` æˆ– `sessionStorage` ä¸­çš„æ•°æ®æ›´æ–°åï¼Œ[storage](https://html.spec.whatwg.org/multipage/webstorage.html#the-storageevent-interface) äº‹ä»¶å°±ä¼šè§¦å‘ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

- `key` â€”â€” å‘ç”Ÿæ›´æ”¹çš„æ•°æ®çš„ `key`ï¼ˆå¦‚æœè°ƒç”¨çš„æ˜¯ `.clear()` æ–¹æ³•ï¼Œåˆ™ä¸º `null`ï¼‰ã€‚
- `oldValue` â€”â€” æ—§å€¼ï¼ˆå¦‚æœæ˜¯æ–°å¢æ•°æ®ï¼Œåˆ™ä¸º `null`ï¼‰ã€‚
- `newValue` â€”â€” æ–°å€¼ï¼ˆå¦‚æœæ˜¯åˆ é™¤æ•°æ®ï¼Œåˆ™ä¸º `null`ï¼‰ã€‚
- `url` â€”â€” å‘ç”Ÿæ•°æ®æ›´æ–°çš„æ–‡æ¡£çš„ urlã€‚
- `storageArea` â€”â€” å‘ç”Ÿæ•°æ®æ›´æ–°çš„ `localStorage` æˆ– `sessionStorage` å¯¹è±¡ã€‚
